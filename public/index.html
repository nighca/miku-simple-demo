<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Miku</title>
  <link rel="stylesheet" href="/style.css">
</head>
<body>
  <div class="container">
    <main class="main">
      <h1 class="title">
        Miku
      </h1>

      <pre class="sample-code"><code>&lt;script src="/miku-delivery-0.11.0.js"&gt;&lt;/script&gt;

&lt;script&gt;
  mikuDelivery.initProxy('/miku-delivery-sw-0.11.0.js', {
    app: { appID: '&lt;APP_ID&gt;', appSalt: '&lt;APP_SALT&gt;' },
    domains: ['ro7756kg8.hb-bkt.clouddn.com']
  })
&lt;/script&gt;</code></pre>

      <ul class="grid">
        <li class="card">
          <h2>Image</h2>
          <img alt="Fabric" src="https://ro7756kg8.hb-bkt.clouddn.com/fabric.jpg" />
          <p className="url">
            <a target="_blank" rel="noreferrer" href="https://ro7756kg8.hb-bkt.clouddn.com/fabric.jpg">
              <code>fabric.jpeg</code>
            </a>
          </p>
        </li>
        <li class="card">
          <h2>Long Video</h2>
          <video controls data-src="https://ro7756kg8.hb-bkt.clouddn.com/the-internets-own-boy.ogv"></video>
          <p className="url">
            <a target="_blank" rel="noreferrer" href="https://ro7756kg8.hb-bkt.clouddn.com/the-internets-own-boy.ogv">
              <code>the-internets-own-boy.ogv</code>
            </a>
          </p>
        </li>
      </ul>
    </main>
  </div>

  <script src="/miku-delivery-0.11.0.js"></script>

  <script>
    mikuDelivery.initProxy('/miku-delivery-sw-0.11.0.js', {
      app: { appID: 'ao89rvrjpyi4gn57', appSalt: 'reimp7tnc2y9p11hckwz10lt3tigw8e7' },
      domains: ['ro7756kg8.hb-bkt.clouddn.com'],
      client: {
        mediaOptimization: {
          // 为方便查看代理效果，这里配置一个较小的首开优化阈值
          threshold: 1024 * 10
        }
      }
    }).finally(() => {
      // 推迟 `<video>`、`<audio>` 加载，避免 chrome 的这个问题 https://bugs.chromium.org/p/chromium/issues/detail?id=1406478
      setTimeout(() => {
        [...document.getElementsByTagName('video'), ...document.getElementsByTagName('audio')].forEach(media => {
          media.setAttribute('src', media.getAttribute('data-src'))
        })
      }, 100)
    })
  </script>

</body>
</html>
