var miku=function(Z){"use strict";var ga=Object.defineProperty,ba=Object.defineProperties;var ma=Object.getOwnPropertyDescriptors;var a0=Object.getOwnPropertySymbols;var Gr=Object.prototype.hasOwnProperty,jr=Object.prototype.propertyIsEnumerable;var lt=(Z,ne,te)=>ne in Z?ga(Z,ne,{enumerable:!0,configurable:!0,writable:!0,value:te}):Z[ne]=te,ee=(Z,ne)=>{for(var te in ne||(ne={}))Gr.call(ne,te)&&lt(Z,te,ne[te]);if(a0)for(var te of a0(ne))jr.call(ne,te)&&lt(Z,te,ne[te]);return Z},me=(Z,ne)=>ba(Z,ma(ne));var Ve=(Z,ne)=>{var te={};for(var le in Z)Gr.call(Z,le)&&ne.indexOf(le)<0&&(te[le]=Z[le]);if(Z!=null&&a0)for(var le of a0(Z))ne.indexOf(le)<0&&jr.call(Z,le)&&(te[le]=Z[le]);return te};var L=(Z,ne,te)=>(lt(Z,typeof ne!="symbol"?ne+"":ne,te),te);var z=(Z,ne,te)=>new Promise((le,We)=>{var o0=ye=>{try{Ne(te.next(ye))}catch(Pe){We(Pe)}},i0=ye=>{try{Ne(te.throw(ye))}catch(Pe){We(Pe)}},Ne=ye=>ye.done?le(ye.value):Promise.resolve(ye.value).then(o0,i0);Ne((te=te.apply(Z,ne)).next())});function ne(s){const e=[],t=s.length;for(let r=0;r<t;r++){let n=s.charCodeAt(r);if(n>=55296&&n<=56319&&t>r+1){const a=s.charCodeAt(r+1);a>=56320&&a<=57343&&(n=(n-55296)*1024+a-56320+65536,r+=1)}if(n<128){e.push(n);continue}if(n<2048){e.push(n>>6|192),e.push(n&63|128);continue}if(n<55296||n>=57344&&n<65536){e.push(n>>12|224),e.push(n>>6&63|128),e.push(n&63|128);continue}if(n>=65536&&n<=1114111){e.push(n>>18|240),e.push(n>>12&63|128),e.push(n>>6&63|128),e.push(n&63|128);continue}e.push(239,191,189)}return new Uint8Array(e).buffer}function te(s){return s^=s>>>16,s=Math.imul(s,2246822507),s^=s>>>13,s=Math.imul(s,3266489909),s^=s>>>16,s>>>0}const le=new Uint32Array([3432918353,461845907]);function We(s,e){return s<<e|s>>>32-e}function o0(s,e){const t=s.byteLength/4|0,r=new Uint32Array(s,0,t);for(let n=0;n<t;n++)r[n]=Math.imul(r[n],le[0]),r[n]=We(r[n],15),r[n]=Math.imul(r[n],le[1]),e[0]=e[0]^r[n],e[0]=We(e[0],13),e[0]=Math.imul(e[0],5)+3864292196}function i0(s,e){const t=s.byteLength/4|0,r=s.byteLength%4;let n=0;const a=new Uint8Array(s,t*4,r);switch(r){case 3:n=n^a[2]<<16;case 2:n=n^a[1]<<8;case 1:n=n^a[0]<<0,n=Math.imul(n,le[0]),n=We(n,15),n=Math.imul(n,le[1]),e[0]=e[0]^n}}function Ne(s,e){e[0]=e[0]^s.byteLength,e[0]=te(e[0])}function ye(s,e){if(e=e?e|0:0,typeof s=="string"&&(s=ne(s)),!(s instanceof ArrayBuffer))throw new TypeError("Expected key to be ArrayBuffer or string");const t=new Uint32Array([e]);return o0(s,t),i0(s,t),Ne(s,t),t.buffer}class Pe{constructor(e=Xr){L(this,"circle",new Map);L(this,"members",new Set);L(this,"membersReplicas",new Map);L(this,"sortedHashes",[]);this.hasher=e}clone(){const e=new Pe;return e.circle=new Map(this.circle),e.members=new Set(this.members),e.membersReplicas=new Map(this.membersReplicas),e.sortedHashes=[...this.sortedHashes],e}updateSortedHashes(){this.sortedHashes=[...this.circle.keys()].sort((e,t)=>e-t)}_add({key:e,replicas:t}){for(let r=0;r<t;r++){const n=this.hasher(ut(e,r));this.circle.set(n,e)}this.members.add(e),this.membersReplicas.set(e,t)}_remove({key:e,replicas:t}){for(let r=0;r<t;r++){const n=this.hasher(ut(e,r));this.circle.delete(n)}this.members.delete(e),this.membersReplicas.delete(e)}get(e){var n;if(this.circle.size===0)return null;const t=this.hasher(e),r=(n=this.sortedHashes.find(a=>a>t))!=null?n:this.sortedHashes[0];return this.circle.get(r)}add(e,t){return this.members.has(e)?!1:(this._add({key:e,replicas:t}),this.updateSortedHashes(),!0)}remove(e){if(!this.members.has(e))return!1;const t=this.membersReplicas.get(e);return this._remove({key:e,replicas:t}),this.updateSortedHashes(),!0}set(e){this.circle.clear(),this.members.clear(),this.membersReplicas.clear(),e.forEach(t=>{this._add(t)}),this.updateSortedHashes()}}function ut(s,e){return e+s}const Xr=Kr;function Kr(s){const e=ye(s);return new Uint32Array(e)[0]}let ft=!1;function we(s){return(...e)=>{ft&&console.debug(`[${s}] [${(Date.now()/1e3).toFixed(3)}]`,...e)}}function ht(){ft=!0}const c0="https://api.qiniudns.com/v1/resolve",dt="https://log.qiniuapi.com",l0="https://pili-zeus.qiniuapi.com/v1/scheduling";function Ye(s){const e=s.get("Content-Length");return e?parseInt(e,10):null}function Vr(s){const e=s.get("Content-Range");return e==null?null:Yr(e)}function Yr(s){const e=s.trim().toLowerCase(),[t,r]=e.split(/\s+/);if(t!=="bytes")throw new Error(`Unit must be bytes: ${s}`);const[n,a]=r.split("/"),d=a==="*"?null:u0(a),[c,x]=(n.includes("-")?n.split("-"):[null,null]).map(i=>u0(i));return{totalSize:d,start:c,end:x}}function Zr(s){const e=s.start!=null&&s.end!=null?`${s.start}-${s.end}`:"*",t=s.totalSize==null?"*":s.totalSize+"";return`bytes ${e}/${t}`}function u0(s){return s?Number(s):null}function xt(s){const e=s.get("Range");return e==null?null:pt(e)}function vt(s){return s.start===0&&s.end==null}function pt(s){const e=s.trim().toLowerCase();if(!e.startsWith("bytes="))throw new Error(`Unit must be bytes: ${s}`);if(e.includes(","))throw new Error(`Multiple range: ${s}`);const[,t,r]=/(\d*)-(\d*)/.exec(e)||[];if(!t&&!r)throw new Error(`Invalid range values: ${s}`);if(!t)throw new Error("Suffix range not supported");const[n,a]=[t,r].map(d=>u0(d));return{start:n,end:a}}function f0(s){var e,t;return`bytes=${(e=s.start)!=null?e:0}-${(t=s.end)!=null?t:""}`}function wt(s){return Object.keys(s).map(e=>[e,s[e]]).filter(([e,t])=>t!==void 0).map(([e,t])=>t===null?e:[e,t].map(encodeURIComponent).join("=")).join("&")}function Qr(s,e,t,r){if(s==="HEAD")return[!1];if(e>=100&&e<200)return[!1];if(e===204||e===304)return[!1];if(s==="CONNECT"&&e>=200&&e<300)return[!1];const n=t.get("Transfer-Encoding");if(n!=null&&n.length>0)return[!0,null];const a=r.get("Content-Length");if(a!=null){const d=parseInt(a,10);if(!Number.isNaN(d))return d===0?[!1]:[!0,d]}return[!0,null]}const Jr=/[^\u0000-\u00ff]/;function gt(s){return Jr.test(s)?"REPLACED_BY_Miku_SEE_Miku_utils_http_encodeHeaderValue":s}function bt(s){if(s instanceof Headers){const e={};s.forEach((t,r)=>{e[r]=gt(t)}),s=e}if(Array.isArray(s)){const e={};s.forEach(([t,r])=>{e[r]=gt(t)}),s=e}return new Headers(s)}function mt(s){var t;let e=null;if(s.status===200){const r=s.headers.get("Content-Length");e=r!=null?parseInt(r,10):null}if(s.status===206){const r=Vr(s.headers);e=(t=r==null?void 0:r.totalSize)!=null?t:null}return e}var U=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function en(s){var e=s.default;if(typeof e=="function"){var t=function(){return e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(s).forEach(function(r){var n=Object.getOwnPropertyDescriptor(s,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return s[r]}})}),t}var yt={exports:{}};function tn(s){throw new Error('Could not dynamically require "'+s+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var h0={exports:{}};const rn=en(Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"})));var _t;function G(){return _t||(_t=1,function(s,e){(function(t,r){s.exports=r()})(U,function(){var t=t||function(r,n){var a;if(typeof window!="undefined"&&window.crypto&&(a=window.crypto),typeof self!="undefined"&&self.crypto&&(a=self.crypto),typeof globalThis!="undefined"&&globalThis.crypto&&(a=globalThis.crypto),!a&&typeof window!="undefined"&&window.msCrypto&&(a=window.msCrypto),!a&&typeof U!="undefined"&&U.crypto&&(a=U.crypto),!a&&typeof tn=="function")try{a=rn}catch(g){}var d=function(){if(a){if(typeof a.getRandomValues=="function")try{return a.getRandomValues(new Uint32Array(1))[0]}catch(g){}if(typeof a.randomBytes=="function")try{return a.randomBytes(4).readInt32LE()}catch(g){}}throw new Error("Native crypto module could not be used to get secure random number.")},c=Object.create||function(){function g(){}return function(p){var b;return g.prototype=p,b=new g,g.prototype=null,b}}(),x={},i=x.lib={},u=i.Base=function(){return{extend:function(g){var p=c(this);return g&&p.mixIn(g),(!p.hasOwnProperty("init")||this.init===p.init)&&(p.init=function(){p.$super.init.apply(this,arguments)}),p.init.prototype=p,p.$super=this,p},create:function(){var g=this.extend();return g.init.apply(g,arguments),g},init:function(){},mixIn:function(g){for(var p in g)g.hasOwnProperty(p)&&(this[p]=g[p]);g.hasOwnProperty("toString")&&(this.toString=g.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),w=i.WordArray=u.extend({init:function(g,p){g=this.words=g||[],p!=n?this.sigBytes=p:this.sigBytes=g.length*4},toString:function(g){return(g||f).stringify(this)},concat:function(g){var p=this.words,b=g.words,_=this.sigBytes,R=g.sigBytes;if(this.clamp(),_%4)for(var k=0;k<R;k++){var S=b[k>>>2]>>>24-k%4*8&255;p[_+k>>>2]|=S<<24-(_+k)%4*8}else for(var T=0;T<R;T+=4)p[_+T>>>2]=b[T>>>2];return this.sigBytes+=R,this},clamp:function(){var g=this.words,p=this.sigBytes;g[p>>>2]&=4294967295<<32-p%4*8,g.length=r.ceil(p/4)},clone:function(){var g=u.clone.call(this);return g.words=this.words.slice(0),g},random:function(g){for(var p=[],b=0;b<g;b+=4)p.push(d());return new w.init(p,g)}}),o=x.enc={},f=o.Hex={stringify:function(g){for(var p=g.words,b=g.sigBytes,_=[],R=0;R<b;R++){var k=p[R>>>2]>>>24-R%4*8&255;_.push((k>>>4).toString(16)),_.push((k&15).toString(16))}return _.join("")},parse:function(g){for(var p=g.length,b=[],_=0;_<p;_+=2)b[_>>>3]|=parseInt(g.substr(_,2),16)<<24-_%8*4;return new w.init(b,p/2)}},l=o.Latin1={stringify:function(g){for(var p=g.words,b=g.sigBytes,_=[],R=0;R<b;R++){var k=p[R>>>2]>>>24-R%4*8&255;_.push(String.fromCharCode(k))}return _.join("")},parse:function(g){for(var p=g.length,b=[],_=0;_<p;_++)b[_>>>2]|=(g.charCodeAt(_)&255)<<24-_%4*8;return new w.init(b,p)}},h=o.Utf8={stringify:function(g){try{return decodeURIComponent(escape(l.stringify(g)))}catch(p){throw new Error("Malformed UTF-8 data")}},parse:function(g){return l.parse(unescape(encodeURIComponent(g)))}},v=i.BufferedBlockAlgorithm=u.extend({reset:function(){this._data=new w.init,this._nDataBytes=0},_append:function(g){typeof g=="string"&&(g=h.parse(g)),this._data.concat(g),this._nDataBytes+=g.sigBytes},_process:function(g){var p,b=this._data,_=b.words,R=b.sigBytes,k=this.blockSize,S=k*4,T=R/S;g?T=r.ceil(T):T=r.max((T|0)-this._minBufferSize,0);var m=T*k,C=r.min(m*4,R);if(m){for(var A=0;A<m;A+=k)this._doProcessBlock(_,A);p=_.splice(0,m),b.sigBytes-=C}return new w.init(p,C)},clone:function(){var g=u.clone.call(this);return g._data=this._data.clone(),g},_minBufferSize:0});i.Hasher=v.extend({cfg:u.extend(),init:function(g){this.cfg=this.cfg.extend(g),this.reset()},reset:function(){v.reset.call(this),this._doReset()},update:function(g){return this._append(g),this._process(),this},finalize:function(g){g&&this._append(g);var p=this._doFinalize();return p},blockSize:16,_createHelper:function(g){return function(p,b){return new g.init(b).finalize(p)}},_createHmacHelper:function(g){return function(p,b){return new y.HMAC.init(g,b).finalize(p)}}});var y=x.algo={};return x}(Math);return t})}(h0)),h0.exports}var d0={exports:{}},Ct;function Ze(){return Ct||(Ct=1,function(s,e){(function(t,r){s.exports=r(G())})(U,function(t){return function(r){var n=t,a=n.lib,d=a.Base,c=a.WordArray,x=n.x64={};x.Word=d.extend({init:function(i,u){this.high=i,this.low=u}}),x.WordArray=d.extend({init:function(i,u){i=this.words=i||[],u!=r?this.sigBytes=u:this.sigBytes=i.length*8},toX32:function(){for(var i=this.words,u=i.length,w=[],o=0;o<u;o++){var f=i[o];w.push(f.high),w.push(f.low)}return c.create(w,this.sigBytes)},clone:function(){for(var i=d.clone.call(this),u=i.words=this.words.slice(0),w=u.length,o=0;o<w;o++)u[o]=u[o].clone();return i}})}(),t})}(d0)),d0.exports}var x0={exports:{}},Rt;function nn(){return Rt||(Rt=1,function(s,e){(function(t,r){s.exports=r(G())})(U,function(t){return function(){if(typeof ArrayBuffer=="function"){var r=t,n=r.lib,a=n.WordArray,d=a.init,c=a.init=function(x){if(x instanceof ArrayBuffer&&(x=new Uint8Array(x)),(x instanceof Int8Array||typeof Uint8ClampedArray!="undefined"&&x instanceof Uint8ClampedArray||x instanceof Int16Array||x instanceof Uint16Array||x instanceof Int32Array||x instanceof Uint32Array||x instanceof Float32Array||x instanceof Float64Array)&&(x=new Uint8Array(x.buffer,x.byteOffset,x.byteLength)),x instanceof Uint8Array){for(var i=x.byteLength,u=[],w=0;w<i;w++)u[w>>>2]|=x[w]<<24-w%4*8;d.call(this,u,i)}else d.apply(this,arguments)};c.prototype=a}}(),t.lib.WordArray})}(x0)),x0.exports}var v0={exports:{}},kt;function sn(){return kt||(kt=1,function(s,e){(function(t,r){s.exports=r(G())})(U,function(t){return function(){var r=t,n=r.lib,a=n.WordArray,d=r.enc;d.Utf16=d.Utf16BE={stringify:function(x){for(var i=x.words,u=x.sigBytes,w=[],o=0;o<u;o+=2){var f=i[o>>>2]>>>16-o%4*8&65535;w.push(String.fromCharCode(f))}return w.join("")},parse:function(x){for(var i=x.length,u=[],w=0;w<i;w++)u[w>>>1]|=x.charCodeAt(w)<<16-w%2*16;return a.create(u,i*2)}},d.Utf16LE={stringify:function(x){for(var i=x.words,u=x.sigBytes,w=[],o=0;o<u;o+=2){var f=c(i[o>>>2]>>>16-o%4*8&65535);w.push(String.fromCharCode(f))}return w.join("")},parse:function(x){for(var i=x.length,u=[],w=0;w<i;w++)u[w>>>1]|=c(x.charCodeAt(w)<<16-w%2*16);return a.create(u,i*2)}};function c(x){return x<<8&4278255360|x>>>8&16711935}}(),t.enc.Utf16})}(v0)),v0.exports}var p0={exports:{}},St;function Oe(){return St||(St=1,function(s,e){(function(t,r){s.exports=r(G())})(U,function(t){return function(){var r=t,n=r.lib,a=n.WordArray,d=r.enc;d.Base64={stringify:function(x){var i=x.words,u=x.sigBytes,w=this._map;x.clamp();for(var o=[],f=0;f<u;f+=3)for(var l=i[f>>>2]>>>24-f%4*8&255,h=i[f+1>>>2]>>>24-(f+1)%4*8&255,v=i[f+2>>>2]>>>24-(f+2)%4*8&255,y=l<<16|h<<8|v,g=0;g<4&&f+g*.75<u;g++)o.push(w.charAt(y>>>6*(3-g)&63));var p=w.charAt(64);if(p)for(;o.length%4;)o.push(p);return o.join("")},parse:function(x){var i=x.length,u=this._map,w=this._reverseMap;if(!w){w=this._reverseMap=[];for(var o=0;o<u.length;o++)w[u.charCodeAt(o)]=o}var f=u.charAt(64);if(f){var l=x.indexOf(f);l!==-1&&(i=l)}return c(x,i,w)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function c(x,i,u){for(var w=[],o=0,f=0;f<i;f++)if(f%4){var l=u[x.charCodeAt(f-1)]<<f%4*2,h=u[x.charCodeAt(f)]>>>6-f%4*2,v=l|h;w[o>>>2]|=v<<24-o%4*8,o++}return a.create(w,o)}}(),t.enc.Base64})}(p0)),p0.exports}var w0={exports:{}},Bt;function an(){return Bt||(Bt=1,function(s,e){(function(t,r){s.exports=r(G())})(U,function(t){return function(){var r=t,n=r.lib,a=n.WordArray,d=r.enc;d.Base64url={stringify:function(x,i=!0){var u=x.words,w=x.sigBytes,o=i?this._safe_map:this._map;x.clamp();for(var f=[],l=0;l<w;l+=3)for(var h=u[l>>>2]>>>24-l%4*8&255,v=u[l+1>>>2]>>>24-(l+1)%4*8&255,y=u[l+2>>>2]>>>24-(l+2)%4*8&255,g=h<<16|v<<8|y,p=0;p<4&&l+p*.75<w;p++)f.push(o.charAt(g>>>6*(3-p)&63));var b=o.charAt(64);if(b)for(;f.length%4;)f.push(b);return f.join("")},parse:function(x,i=!0){var u=x.length,w=i?this._safe_map:this._map,o=this._reverseMap;if(!o){o=this._reverseMap=[];for(var f=0;f<w.length;f++)o[w.charCodeAt(f)]=f}var l=w.charAt(64);if(l){var h=x.indexOf(l);h!==-1&&(u=h)}return c(x,u,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"};function c(x,i,u){for(var w=[],o=0,f=0;f<i;f++)if(f%4){var l=u[x.charCodeAt(f-1)]<<f%4*2,h=u[x.charCodeAt(f)]>>>6-f%4*2,v=l|h;w[o>>>2]|=v<<24-o%4*8,o++}return a.create(w,o)}}(),t.enc.Base64url})}(w0)),w0.exports}var g0={exports:{}},Et;function Fe(){return Et||(Et=1,function(s,e){(function(t,r){s.exports=r(G())})(U,function(t){return function(r){var n=t,a=n.lib,d=a.WordArray,c=a.Hasher,x=n.algo,i=[];(function(){for(var h=0;h<64;h++)i[h]=r.abs(r.sin(h+1))*4294967296|0})();var u=x.MD5=c.extend({_doReset:function(){this._hash=new d.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(h,v){for(var y=0;y<16;y++){var g=v+y,p=h[g];h[g]=(p<<8|p>>>24)&16711935|(p<<24|p>>>8)&4278255360}var b=this._hash.words,_=h[v+0],R=h[v+1],k=h[v+2],S=h[v+3],T=h[v+4],m=h[v+5],C=h[v+6],A=h[v+7],B=h[v+8],q=h[v+9],W=h[v+10],F=h[v+11],j=h[v+12],X=h[v+13],V=h[v+14],K=h[v+15],E=b[0],H=b[1],P=b[2],D=b[3];E=w(E,H,P,D,_,7,i[0]),D=w(D,E,H,P,R,12,i[1]),P=w(P,D,E,H,k,17,i[2]),H=w(H,P,D,E,S,22,i[3]),E=w(E,H,P,D,T,7,i[4]),D=w(D,E,H,P,m,12,i[5]),P=w(P,D,E,H,C,17,i[6]),H=w(H,P,D,E,A,22,i[7]),E=w(E,H,P,D,B,7,i[8]),D=w(D,E,H,P,q,12,i[9]),P=w(P,D,E,H,W,17,i[10]),H=w(H,P,D,E,F,22,i[11]),E=w(E,H,P,D,j,7,i[12]),D=w(D,E,H,P,X,12,i[13]),P=w(P,D,E,H,V,17,i[14]),H=w(H,P,D,E,K,22,i[15]),E=o(E,H,P,D,R,5,i[16]),D=o(D,E,H,P,C,9,i[17]),P=o(P,D,E,H,F,14,i[18]),H=o(H,P,D,E,_,20,i[19]),E=o(E,H,P,D,m,5,i[20]),D=o(D,E,H,P,W,9,i[21]),P=o(P,D,E,H,K,14,i[22]),H=o(H,P,D,E,T,20,i[23]),E=o(E,H,P,D,q,5,i[24]),D=o(D,E,H,P,V,9,i[25]),P=o(P,D,E,H,S,14,i[26]),H=o(H,P,D,E,B,20,i[27]),E=o(E,H,P,D,X,5,i[28]),D=o(D,E,H,P,k,9,i[29]),P=o(P,D,E,H,A,14,i[30]),H=o(H,P,D,E,j,20,i[31]),E=f(E,H,P,D,m,4,i[32]),D=f(D,E,H,P,B,11,i[33]),P=f(P,D,E,H,F,16,i[34]),H=f(H,P,D,E,V,23,i[35]),E=f(E,H,P,D,R,4,i[36]),D=f(D,E,H,P,T,11,i[37]),P=f(P,D,E,H,A,16,i[38]),H=f(H,P,D,E,W,23,i[39]),E=f(E,H,P,D,X,4,i[40]),D=f(D,E,H,P,_,11,i[41]),P=f(P,D,E,H,S,16,i[42]),H=f(H,P,D,E,C,23,i[43]),E=f(E,H,P,D,q,4,i[44]),D=f(D,E,H,P,j,11,i[45]),P=f(P,D,E,H,K,16,i[46]),H=f(H,P,D,E,k,23,i[47]),E=l(E,H,P,D,_,6,i[48]),D=l(D,E,H,P,A,10,i[49]),P=l(P,D,E,H,V,15,i[50]),H=l(H,P,D,E,m,21,i[51]),E=l(E,H,P,D,j,6,i[52]),D=l(D,E,H,P,S,10,i[53]),P=l(P,D,E,H,W,15,i[54]),H=l(H,P,D,E,R,21,i[55]),E=l(E,H,P,D,B,6,i[56]),D=l(D,E,H,P,K,10,i[57]),P=l(P,D,E,H,C,15,i[58]),H=l(H,P,D,E,X,21,i[59]),E=l(E,H,P,D,T,6,i[60]),D=l(D,E,H,P,F,10,i[61]),P=l(P,D,E,H,k,15,i[62]),H=l(H,P,D,E,q,21,i[63]),b[0]=b[0]+E|0,b[1]=b[1]+H|0,b[2]=b[2]+P|0,b[3]=b[3]+D|0},_doFinalize:function(){var h=this._data,v=h.words,y=this._nDataBytes*8,g=h.sigBytes*8;v[g>>>5]|=128<<24-g%32;var p=r.floor(y/4294967296),b=y;v[(g+64>>>9<<4)+15]=(p<<8|p>>>24)&16711935|(p<<24|p>>>8)&4278255360,v[(g+64>>>9<<4)+14]=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360,h.sigBytes=(v.length+1)*4,this._process();for(var _=this._hash,R=_.words,k=0;k<4;k++){var S=R[k];R[k]=(S<<8|S>>>24)&16711935|(S<<24|S>>>8)&4278255360}return _},clone:function(){var h=c.clone.call(this);return h._hash=this._hash.clone(),h}});function w(h,v,y,g,p,b,_){var R=h+(v&y|~v&g)+p+_;return(R<<b|R>>>32-b)+v}function o(h,v,y,g,p,b,_){var R=h+(v&g|y&~g)+p+_;return(R<<b|R>>>32-b)+v}function f(h,v,y,g,p,b,_){var R=h+(v^y^g)+p+_;return(R<<b|R>>>32-b)+v}function l(h,v,y,g,p,b,_){var R=h+(y^(v|~g))+p+_;return(R<<b|R>>>32-b)+v}n.MD5=c._createHelper(u),n.HmacMD5=c._createHmacHelper(u)}(Math),t.MD5})}(g0)),g0.exports}var b0={exports:{}},At;function m0(){return At||(At=1,function(s,e){(function(t,r){s.exports=r(G())})(U,function(t){return function(){var r=t,n=r.lib,a=n.WordArray,d=n.Hasher,c=r.algo,x=[],i=c.SHA1=d.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(u,w){for(var o=this._hash.words,f=o[0],l=o[1],h=o[2],v=o[3],y=o[4],g=0;g<80;g++){if(g<16)x[g]=u[w+g]|0;else{var p=x[g-3]^x[g-8]^x[g-14]^x[g-16];x[g]=p<<1|p>>>31}var b=(f<<5|f>>>27)+y+x[g];g<20?b+=(l&h|~l&v)+1518500249:g<40?b+=(l^h^v)+1859775393:g<60?b+=(l&h|l&v|h&v)-1894007588:b+=(l^h^v)-899497514,y=v,v=h,h=l<<30|l>>>2,l=f,f=b}o[0]=o[0]+f|0,o[1]=o[1]+l|0,o[2]=o[2]+h|0,o[3]=o[3]+v|0,o[4]=o[4]+y|0},_doFinalize:function(){var u=this._data,w=u.words,o=this._nDataBytes*8,f=u.sigBytes*8;return w[f>>>5]|=128<<24-f%32,w[(f+64>>>9<<4)+14]=Math.floor(o/4294967296),w[(f+64>>>9<<4)+15]=o,u.sigBytes=w.length*4,this._process(),this._hash},clone:function(){var u=d.clone.call(this);return u._hash=this._hash.clone(),u}});r.SHA1=d._createHelper(i),r.HmacSHA1=d._createHmacHelper(i)}(),t.SHA1})}(b0)),b0.exports}var y0={exports:{}},Dt;function Ht(){return Dt||(Dt=1,function(s,e){(function(t,r){s.exports=r(G())})(U,function(t){return function(r){var n=t,a=n.lib,d=a.WordArray,c=a.Hasher,x=n.algo,i=[],u=[];(function(){function f(y){for(var g=r.sqrt(y),p=2;p<=g;p++)if(!(y%p))return!1;return!0}function l(y){return(y-(y|0))*4294967296|0}for(var h=2,v=0;v<64;)f(h)&&(v<8&&(i[v]=l(r.pow(h,.5))),u[v]=l(r.pow(h,.3333333333333333)),v++),h++})();var w=[],o=x.SHA256=c.extend({_doReset:function(){this._hash=new d.init(i.slice(0))},_doProcessBlock:function(f,l){for(var h=this._hash.words,v=h[0],y=h[1],g=h[2],p=h[3],b=h[4],_=h[5],R=h[6],k=h[7],S=0;S<64;S++){if(S<16)w[S]=f[l+S]|0;else{var T=w[S-15],m=(T<<25|T>>>7)^(T<<14|T>>>18)^T>>>3,C=w[S-2],A=(C<<15|C>>>17)^(C<<13|C>>>19)^C>>>10;w[S]=m+w[S-7]+A+w[S-16]}var B=b&_^~b&R,q=v&y^v&g^y&g,W=(v<<30|v>>>2)^(v<<19|v>>>13)^(v<<10|v>>>22),F=(b<<26|b>>>6)^(b<<21|b>>>11)^(b<<7|b>>>25),j=k+F+B+u[S]+w[S],X=W+q;k=R,R=_,_=b,b=p+j|0,p=g,g=y,y=v,v=j+X|0}h[0]=h[0]+v|0,h[1]=h[1]+y|0,h[2]=h[2]+g|0,h[3]=h[3]+p|0,h[4]=h[4]+b|0,h[5]=h[5]+_|0,h[6]=h[6]+R|0,h[7]=h[7]+k|0},_doFinalize:function(){var f=this._data,l=f.words,h=this._nDataBytes*8,v=f.sigBytes*8;return l[v>>>5]|=128<<24-v%32,l[(v+64>>>9<<4)+14]=r.floor(h/4294967296),l[(v+64>>>9<<4)+15]=h,f.sigBytes=l.length*4,this._process(),this._hash},clone:function(){var f=c.clone.call(this);return f._hash=this._hash.clone(),f}});n.SHA256=c._createHelper(o),n.HmacSHA256=c._createHmacHelper(o)}(Math),t.SHA256})}(y0)),y0.exports}var _0={exports:{}},Pt;function on(){return Pt||(Pt=1,function(s,e){(function(t,r,n){s.exports=r(G(),Ht())})(U,function(t){return function(){var r=t,n=r.lib,a=n.WordArray,d=r.algo,c=d.SHA256,x=d.SHA224=c.extend({_doReset:function(){this._hash=new a.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var i=c._doFinalize.call(this);return i.sigBytes-=4,i}});r.SHA224=c._createHelper(x),r.HmacSHA224=c._createHmacHelper(x)}(),t.SHA224})}(_0)),_0.exports}var C0={exports:{}},Tt;function zt(){return Tt||(Tt=1,function(s,e){(function(t,r,n){s.exports=r(G(),Ze())})(U,function(t){return function(){var r=t,n=r.lib,a=n.Hasher,d=r.x64,c=d.Word,x=d.WordArray,i=r.algo;function u(){return c.create.apply(c,arguments)}var w=[u(1116352408,3609767458),u(1899447441,602891725),u(3049323471,3964484399),u(3921009573,2173295548),u(961987163,4081628472),u(1508970993,3053834265),u(2453635748,2937671579),u(2870763221,3664609560),u(3624381080,2734883394),u(310598401,1164996542),u(607225278,1323610764),u(1426881987,3590304994),u(1925078388,4068182383),u(2162078206,991336113),u(2614888103,633803317),u(3248222580,3479774868),u(3835390401,2666613458),u(4022224774,944711139),u(264347078,2341262773),u(604807628,2007800933),u(770255983,1495990901),u(1249150122,1856431235),u(1555081692,3175218132),u(1996064986,2198950837),u(2554220882,3999719339),u(2821834349,766784016),u(2952996808,2566594879),u(3210313671,3203337956),u(3336571891,1034457026),u(3584528711,2466948901),u(113926993,3758326383),u(338241895,168717936),u(666307205,1188179964),u(773529912,1546045734),u(1294757372,1522805485),u(1396182291,2643833823),u(1695183700,2343527390),u(1986661051,1014477480),u(2177026350,1206759142),u(2456956037,344077627),u(2730485921,1290863460),u(2820302411,3158454273),u(3259730800,3505952657),u(3345764771,106217008),u(3516065817,3606008344),u(3600352804,1432725776),u(4094571909,1467031594),u(275423344,851169720),u(430227734,3100823752),u(506948616,1363258195),u(659060556,3750685593),u(883997877,3785050280),u(958139571,3318307427),u(1322822218,3812723403),u(1537002063,2003034995),u(1747873779,3602036899),u(1955562222,1575990012),u(2024104815,1125592928),u(2227730452,2716904306),u(2361852424,442776044),u(2428436474,593698344),u(2756734187,3733110249),u(3204031479,2999351573),u(3329325298,3815920427),u(3391569614,3928383900),u(3515267271,566280711),u(3940187606,3454069534),u(4118630271,4000239992),u(116418474,1914138554),u(174292421,2731055270),u(289380356,3203993006),u(460393269,320620315),u(685471733,587496836),u(852142971,1086792851),u(1017036298,365543100),u(1126000580,2618297676),u(1288033470,3409855158),u(1501505948,4234509866),u(1607167915,987167468),u(1816402316,1246189591)],o=[];(function(){for(var l=0;l<80;l++)o[l]=u()})();var f=i.SHA512=a.extend({_doReset:function(){this._hash=new x.init([new c.init(1779033703,4089235720),new c.init(3144134277,2227873595),new c.init(1013904242,4271175723),new c.init(2773480762,1595750129),new c.init(1359893119,2917565137),new c.init(2600822924,725511199),new c.init(528734635,4215389547),new c.init(1541459225,327033209)])},_doProcessBlock:function(l,h){for(var v=this._hash.words,y=v[0],g=v[1],p=v[2],b=v[3],_=v[4],R=v[5],k=v[6],S=v[7],T=y.high,m=y.low,C=g.high,A=g.low,B=p.high,q=p.low,W=b.high,F=b.low,j=_.high,X=_.low,V=R.high,K=R.low,E=k.high,H=k.low,P=S.high,D=S.low,Q=T,Y=m,ce=C,N=A,ge=B,Re=q,ke=W,ze=F,fe=j,ae=X,Be=V,Le=K,qe=E,Ee=H,he=P,pe=D,ue=0;ue<80;ue++){var O,$,M=o[ue];if(ue<16)$=M.high=l[h+ue*2]|0,O=M.low=l[h+ue*2+1]|0;else{var re=o[ue-15],I=re.high,be=re.low,J=(I>>>1|be<<31)^(I>>>8|be<<24)^I>>>7,Ae=(be>>>1|I<<31)^(be>>>8|I<<24)^(be>>>7|I<<25),de=o[ue-2],Se=de.high,De=de.low,oa=(Se>>>19|De<<13)^(Se<<3|De>>>29)^Se>>>6,qr=(De>>>19|Se<<13)^(De<<3|Se>>>29)^(De>>>6|Se<<26),Wr=o[ue-7],ia=Wr.high,ca=Wr.low,Or=o[ue-16],la=Or.high,Fr=Or.low;O=Ae+ca,$=J+ia+(O>>>0<Ae>>>0?1:0),O=O+qr,$=$+oa+(O>>>0<qr>>>0?1:0),O=O+Fr,$=$+la+(O>>>0<Fr>>>0?1:0),M.high=$,M.low=O}var ua=fe&Be^~fe&qe,Ir=ae&Le^~ae&Ee,fa=Q&ce^Q&ge^ce&ge,ha=Y&N^Y&Re^N&Re,da=(Q>>>28|Y<<4)^(Q<<30|Y>>>2)^(Q<<25|Y>>>7),Nr=(Y>>>28|Q<<4)^(Y<<30|Q>>>2)^(Y<<25|Q>>>7),xa=(fe>>>14|ae<<18)^(fe>>>18|ae<<14)^(fe<<23|ae>>>9),va=(ae>>>14|fe<<18)^(ae>>>18|fe<<14)^(ae<<23|fe>>>9),Mr=w[ue],pa=Mr.high,Ur=Mr.low,xe=pe+va,He=he+xa+(xe>>>0<pe>>>0?1:0),xe=xe+Ir,He=He+ua+(xe>>>0<Ir>>>0?1:0),xe=xe+Ur,He=He+pa+(xe>>>0<Ur>>>0?1:0),xe=xe+O,He=He+$+(xe>>>0<O>>>0?1:0),$r=Nr+ha,wa=da+fa+($r>>>0<Nr>>>0?1:0);he=qe,pe=Ee,qe=Be,Ee=Le,Be=fe,Le=ae,ae=ze+xe|0,fe=ke+He+(ae>>>0<ze>>>0?1:0)|0,ke=ge,ze=Re,ge=ce,Re=N,ce=Q,N=Y,Y=xe+$r|0,Q=He+wa+(Y>>>0<xe>>>0?1:0)|0}m=y.low=m+Y,y.high=T+Q+(m>>>0<Y>>>0?1:0),A=g.low=A+N,g.high=C+ce+(A>>>0<N>>>0?1:0),q=p.low=q+Re,p.high=B+ge+(q>>>0<Re>>>0?1:0),F=b.low=F+ze,b.high=W+ke+(F>>>0<ze>>>0?1:0),X=_.low=X+ae,_.high=j+fe+(X>>>0<ae>>>0?1:0),K=R.low=K+Le,R.high=V+Be+(K>>>0<Le>>>0?1:0),H=k.low=H+Ee,k.high=E+qe+(H>>>0<Ee>>>0?1:0),D=S.low=D+pe,S.high=P+he+(D>>>0<pe>>>0?1:0)},_doFinalize:function(){var l=this._data,h=l.words,v=this._nDataBytes*8,y=l.sigBytes*8;h[y>>>5]|=128<<24-y%32,h[(y+128>>>10<<5)+30]=Math.floor(v/4294967296),h[(y+128>>>10<<5)+31]=v,l.sigBytes=h.length*4,this._process();var g=this._hash.toX32();return g},clone:function(){var l=a.clone.call(this);return l._hash=this._hash.clone(),l},blockSize:1024/32});r.SHA512=a._createHelper(f),r.HmacSHA512=a._createHmacHelper(f)}(),t.SHA512})}(C0)),C0.exports}var R0={exports:{}},Lt;function cn(){return Lt||(Lt=1,function(s,e){(function(t,r,n){s.exports=r(G(),Ze(),zt())})(U,function(t){return function(){var r=t,n=r.x64,a=n.Word,d=n.WordArray,c=r.algo,x=c.SHA512,i=c.SHA384=x.extend({_doReset:function(){this._hash=new d.init([new a.init(3418070365,3238371032),new a.init(1654270250,914150663),new a.init(2438529370,812702999),new a.init(355462360,4144912697),new a.init(1731405415,4290775857),new a.init(2394180231,1750603025),new a.init(3675008525,1694076839),new a.init(1203062813,3204075428)])},_doFinalize:function(){var u=x._doFinalize.call(this);return u.sigBytes-=16,u}});r.SHA384=x._createHelper(i),r.HmacSHA384=x._createHmacHelper(i)}(),t.SHA384})}(R0)),R0.exports}var k0={exports:{}},qt;function ln(){return qt||(qt=1,function(s,e){(function(t,r,n){s.exports=r(G(),Ze())})(U,function(t){return function(r){var n=t,a=n.lib,d=a.WordArray,c=a.Hasher,x=n.x64,i=x.Word,u=n.algo,w=[],o=[],f=[];(function(){for(var v=1,y=0,g=0;g<24;g++){w[v+5*y]=(g+1)*(g+2)/2%64;var p=y%5,b=(2*v+3*y)%5;v=p,y=b}for(var v=0;v<5;v++)for(var y=0;y<5;y++)o[v+5*y]=y+(2*v+3*y)%5*5;for(var _=1,R=0;R<24;R++){for(var k=0,S=0,T=0;T<7;T++){if(_&1){var m=(1<<T)-1;m<32?S^=1<<m:k^=1<<m-32}_&128?_=_<<1^113:_<<=1}f[R]=i.create(k,S)}})();var l=[];(function(){for(var v=0;v<25;v++)l[v]=i.create()})();var h=u.SHA3=c.extend({cfg:c.cfg.extend({outputLength:512}),_doReset:function(){for(var v=this._state=[],y=0;y<25;y++)v[y]=new i.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(v,y){for(var g=this._state,p=this.blockSize/2,b=0;b<p;b++){var _=v[y+2*b],R=v[y+2*b+1];_=(_<<8|_>>>24)&16711935|(_<<24|_>>>8)&4278255360,R=(R<<8|R>>>24)&16711935|(R<<24|R>>>8)&4278255360;var k=g[b];k.high^=R,k.low^=_}for(var S=0;S<24;S++){for(var T=0;T<5;T++){for(var m=0,C=0,A=0;A<5;A++){var k=g[T+5*A];m^=k.high,C^=k.low}var B=l[T];B.high=m,B.low=C}for(var T=0;T<5;T++)for(var q=l[(T+4)%5],W=l[(T+1)%5],F=W.high,j=W.low,m=q.high^(F<<1|j>>>31),C=q.low^(j<<1|F>>>31),A=0;A<5;A++){var k=g[T+5*A];k.high^=m,k.low^=C}for(var X=1;X<25;X++){var m,C,k=g[X],V=k.high,K=k.low,E=w[X];E<32?(m=V<<E|K>>>32-E,C=K<<E|V>>>32-E):(m=K<<E-32|V>>>64-E,C=V<<E-32|K>>>64-E);var H=l[o[X]];H.high=m,H.low=C}var P=l[0],D=g[0];P.high=D.high,P.low=D.low;for(var T=0;T<5;T++)for(var A=0;A<5;A++){var X=T+5*A,k=g[X],Q=l[X],Y=l[(T+1)%5+5*A],ce=l[(T+2)%5+5*A];k.high=Q.high^~Y.high&ce.high,k.low=Q.low^~Y.low&ce.low}var k=g[0],N=f[S];k.high^=N.high,k.low^=N.low}},_doFinalize:function(){var v=this._data,y=v.words;this._nDataBytes*8;var g=v.sigBytes*8,p=this.blockSize*32;y[g>>>5]|=1<<24-g%32,y[(r.ceil((g+1)/p)*p>>>5)-1]|=128,v.sigBytes=y.length*4,this._process();for(var b=this._state,_=this.cfg.outputLength/8,R=_/8,k=[],S=0;S<R;S++){var T=b[S],m=T.high,C=T.low;m=(m<<8|m>>>24)&16711935|(m<<24|m>>>8)&4278255360,C=(C<<8|C>>>24)&16711935|(C<<24|C>>>8)&4278255360,k.push(C),k.push(m)}return new d.init(k,_)},clone:function(){for(var v=c.clone.call(this),y=v._state=this._state.slice(0),g=0;g<25;g++)y[g]=y[g].clone();return v}});n.SHA3=c._createHelper(h),n.HmacSHA3=c._createHmacHelper(h)}(Math),t.SHA3})}(k0)),k0.exports}var S0={exports:{}},Wt;function un(){return Wt||(Wt=1,function(s,e){(function(t,r){s.exports=r(G())})(U,function(t){/** @preserve
  			(c) 2012 by CÃ©dric Mesnil. All rights reserved.

  			Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:

  			    - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
  			    - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.

  			THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
  			*/return function(r){var n=t,a=n.lib,d=a.WordArray,c=a.Hasher,x=n.algo,i=d.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),u=d.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),w=d.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),o=d.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),f=d.create([0,1518500249,1859775393,2400959708,2840853838]),l=d.create([1352829926,1548603684,1836072691,2053994217,0]),h=x.RIPEMD160=c.extend({_doReset:function(){this._hash=d.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(R,k){for(var S=0;S<16;S++){var T=k+S,m=R[T];R[T]=(m<<8|m>>>24)&16711935|(m<<24|m>>>8)&4278255360}var C=this._hash.words,A=f.words,B=l.words,q=i.words,W=u.words,F=w.words,j=o.words,X,V,K,E,H,P,D,Q,Y,ce;P=X=C[0],D=V=C[1],Q=K=C[2],Y=E=C[3],ce=H=C[4];for(var N,S=0;S<80;S+=1)N=X+R[k+q[S]]|0,S<16?N+=v(V,K,E)+A[0]:S<32?N+=y(V,K,E)+A[1]:S<48?N+=g(V,K,E)+A[2]:S<64?N+=p(V,K,E)+A[3]:N+=b(V,K,E)+A[4],N=N|0,N=_(N,F[S]),N=N+H|0,X=H,H=E,E=_(K,10),K=V,V=N,N=P+R[k+W[S]]|0,S<16?N+=b(D,Q,Y)+B[0]:S<32?N+=p(D,Q,Y)+B[1]:S<48?N+=g(D,Q,Y)+B[2]:S<64?N+=y(D,Q,Y)+B[3]:N+=v(D,Q,Y)+B[4],N=N|0,N=_(N,j[S]),N=N+ce|0,P=ce,ce=Y,Y=_(Q,10),Q=D,D=N;N=C[1]+K+Y|0,C[1]=C[2]+E+ce|0,C[2]=C[3]+H+P|0,C[3]=C[4]+X+D|0,C[4]=C[0]+V+Q|0,C[0]=N},_doFinalize:function(){var R=this._data,k=R.words,S=this._nDataBytes*8,T=R.sigBytes*8;k[T>>>5]|=128<<24-T%32,k[(T+64>>>9<<4)+14]=(S<<8|S>>>24)&16711935|(S<<24|S>>>8)&4278255360,R.sigBytes=(k.length+1)*4,this._process();for(var m=this._hash,C=m.words,A=0;A<5;A++){var B=C[A];C[A]=(B<<8|B>>>24)&16711935|(B<<24|B>>>8)&4278255360}return m},clone:function(){var R=c.clone.call(this);return R._hash=this._hash.clone(),R}});function v(R,k,S){return R^k^S}function y(R,k,S){return R&k|~R&S}function g(R,k,S){return(R|~k)^S}function p(R,k,S){return R&S|k&~S}function b(R,k,S){return R^(k|~S)}function _(R,k){return R<<k|R>>>32-k}n.RIPEMD160=c._createHelper(h),n.HmacRIPEMD160=c._createHmacHelper(h)}(),t.RIPEMD160})}(S0)),S0.exports}var B0={exports:{}},Ot;function E0(){return Ot||(Ot=1,function(s,e){(function(t,r){s.exports=r(G())})(U,function(t){(function(){var r=t,n=r.lib,a=n.Base,d=r.enc,c=d.Utf8,x=r.algo;x.HMAC=a.extend({init:function(i,u){i=this._hasher=new i.init,typeof u=="string"&&(u=c.parse(u));var w=i.blockSize,o=w*4;u.sigBytes>o&&(u=i.finalize(u)),u.clamp();for(var f=this._oKey=u.clone(),l=this._iKey=u.clone(),h=f.words,v=l.words,y=0;y<w;y++)h[y]^=1549556828,v[y]^=909522486;f.sigBytes=l.sigBytes=o,this.reset()},reset:function(){var i=this._hasher;i.reset(),i.update(this._iKey)},update:function(i){return this._hasher.update(i),this},finalize:function(i){var u=this._hasher,w=u.finalize(i);u.reset();var o=u.finalize(this._oKey.clone().concat(w));return o}})})()})}(B0)),B0.exports}var A0={exports:{}},Ft;function fn(){return Ft||(Ft=1,function(s,e){(function(t,r,n){s.exports=r(G(),m0(),E0())})(U,function(t){return function(){var r=t,n=r.lib,a=n.Base,d=n.WordArray,c=r.algo,x=c.SHA1,i=c.HMAC,u=c.PBKDF2=a.extend({cfg:a.extend({keySize:128/32,hasher:x,iterations:1}),init:function(w){this.cfg=this.cfg.extend(w)},compute:function(w,o){for(var f=this.cfg,l=i.create(f.hasher,w),h=d.create(),v=d.create([1]),y=h.words,g=v.words,p=f.keySize,b=f.iterations;y.length<p;){var _=l.update(o).finalize(v);l.reset();for(var R=_.words,k=R.length,S=_,T=1;T<b;T++){S=l.finalize(S),l.reset();for(var m=S.words,C=0;C<k;C++)R[C]^=m[C]}h.concat(_),g[0]++}return h.sigBytes=p*4,h}});r.PBKDF2=function(w,o,f){return u.create(f).compute(w,o)}}(),t.PBKDF2})}(A0)),A0.exports}var D0={exports:{}},It;function Te(){return It||(It=1,function(s,e){(function(t,r,n){s.exports=r(G(),m0(),E0())})(U,function(t){return function(){var r=t,n=r.lib,a=n.Base,d=n.WordArray,c=r.algo,x=c.MD5,i=c.EvpKDF=a.extend({cfg:a.extend({keySize:128/32,hasher:x,iterations:1}),init:function(u){this.cfg=this.cfg.extend(u)},compute:function(u,w){for(var o,f=this.cfg,l=f.hasher.create(),h=d.create(),v=h.words,y=f.keySize,g=f.iterations;v.length<y;){o&&l.update(o),o=l.update(u).finalize(w),l.reset();for(var p=1;p<g;p++)o=l.finalize(o),l.reset();h.concat(o)}return h.sigBytes=y*4,h}});r.EvpKDF=function(u,w,o){return i.create(o).compute(u,w)}}(),t.EvpKDF})}(D0)),D0.exports}var H0={exports:{}},Nt;function ie(){return Nt||(Nt=1,function(s,e){(function(t,r,n){s.exports=r(G(),Te())})(U,function(t){t.lib.Cipher||function(r){var n=t,a=n.lib,d=a.Base,c=a.WordArray,x=a.BufferedBlockAlgorithm,i=n.enc;i.Utf8;var u=i.Base64,w=n.algo,o=w.EvpKDF,f=a.Cipher=x.extend({cfg:d.extend(),createEncryptor:function(m,C){return this.create(this._ENC_XFORM_MODE,m,C)},createDecryptor:function(m,C){return this.create(this._DEC_XFORM_MODE,m,C)},init:function(m,C,A){this.cfg=this.cfg.extend(A),this._xformMode=m,this._key=C,this.reset()},reset:function(){x.reset.call(this),this._doReset()},process:function(m){return this._append(m),this._process()},finalize:function(m){m&&this._append(m);var C=this._doFinalize();return C},keySize:128/32,ivSize:128/32,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function m(C){return typeof C=="string"?T:R}return function(C){return{encrypt:function(A,B,q){return m(B).encrypt(C,A,B,q)},decrypt:function(A,B,q){return m(B).decrypt(C,A,B,q)}}}}()});a.StreamCipher=f.extend({_doFinalize:function(){var m=this._process(!0);return m},blockSize:1});var l=n.mode={},h=a.BlockCipherMode=d.extend({createEncryptor:function(m,C){return this.Encryptor.create(m,C)},createDecryptor:function(m,C){return this.Decryptor.create(m,C)},init:function(m,C){this._cipher=m,this._iv=C}}),v=l.CBC=function(){var m=h.extend();m.Encryptor=m.extend({processBlock:function(A,B){var q=this._cipher,W=q.blockSize;C.call(this,A,B,W),q.encryptBlock(A,B),this._prevBlock=A.slice(B,B+W)}}),m.Decryptor=m.extend({processBlock:function(A,B){var q=this._cipher,W=q.blockSize,F=A.slice(B,B+W);q.decryptBlock(A,B),C.call(this,A,B,W),this._prevBlock=F}});function C(A,B,q){var W,F=this._iv;F?(W=F,this._iv=r):W=this._prevBlock;for(var j=0;j<q;j++)A[B+j]^=W[j]}return m}(),y=n.pad={},g=y.Pkcs7={pad:function(m,C){for(var A=C*4,B=A-m.sigBytes%A,q=B<<24|B<<16|B<<8|B,W=[],F=0;F<B;F+=4)W.push(q);var j=c.create(W,B);m.concat(j)},unpad:function(m){var C=m.words[m.sigBytes-1>>>2]&255;m.sigBytes-=C}};a.BlockCipher=f.extend({cfg:f.cfg.extend({mode:v,padding:g}),reset:function(){var m;f.reset.call(this);var C=this.cfg,A=C.iv,B=C.mode;this._xformMode==this._ENC_XFORM_MODE?m=B.createEncryptor:(m=B.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==m?this._mode.init(this,A&&A.words):(this._mode=m.call(B,this,A&&A.words),this._mode.__creator=m)},_doProcessBlock:function(m,C){this._mode.processBlock(m,C)},_doFinalize:function(){var m,C=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(C.pad(this._data,this.blockSize),m=this._process(!0)):(m=this._process(!0),C.unpad(m)),m},blockSize:4});var p=a.CipherParams=d.extend({init:function(m){this.mixIn(m)},toString:function(m){return(m||this.formatter).stringify(this)}}),b=n.format={},_=b.OpenSSL={stringify:function(m){var C,A=m.ciphertext,B=m.salt;return B?C=c.create([1398893684,1701076831]).concat(B).concat(A):C=A,C.toString(u)},parse:function(m){var C,A=u.parse(m),B=A.words;return B[0]==1398893684&&B[1]==1701076831&&(C=c.create(B.slice(2,4)),B.splice(0,4),A.sigBytes-=16),p.create({ciphertext:A,salt:C})}},R=a.SerializableCipher=d.extend({cfg:d.extend({format:_}),encrypt:function(m,C,A,B){B=this.cfg.extend(B);var q=m.createEncryptor(A,B),W=q.finalize(C),F=q.cfg;return p.create({ciphertext:W,key:A,iv:F.iv,algorithm:m,mode:F.mode,padding:F.padding,blockSize:m.blockSize,formatter:B.format})},decrypt:function(m,C,A,B){B=this.cfg.extend(B),C=this._parse(C,B.format);var q=m.createDecryptor(A,B).finalize(C.ciphertext);return q},_parse:function(m,C){return typeof m=="string"?C.parse(m,this):m}}),k=n.kdf={},S=k.OpenSSL={execute:function(m,C,A,B){B||(B=c.random(64/8));var q=o.create({keySize:C+A}).compute(m,B),W=c.create(q.words.slice(C),A*4);return q.sigBytes=C*4,p.create({key:q,iv:W,salt:B})}},T=a.PasswordBasedCipher=R.extend({cfg:R.cfg.extend({kdf:S}),encrypt:function(m,C,A,B){B=this.cfg.extend(B);var q=B.kdf.execute(A,m.keySize,m.ivSize);B.iv=q.iv;var W=R.encrypt.call(this,m,C,q.key,B);return W.mixIn(q),W},decrypt:function(m,C,A,B){B=this.cfg.extend(B),C=this._parse(C,B.format);var q=B.kdf.execute(A,m.keySize,m.ivSize,C.salt);B.iv=q.iv;var W=R.decrypt.call(this,m,C,q.key,B);return W}})}()})}(H0)),H0.exports}var P0={exports:{}},Mt;function hn(){return Mt||(Mt=1,function(s,e){(function(t,r,n){s.exports=r(G(),ie())})(U,function(t){return t.mode.CFB=function(){var r=t.lib.BlockCipherMode.extend();r.Encryptor=r.extend({processBlock:function(a,d){var c=this._cipher,x=c.blockSize;n.call(this,a,d,x,c),this._prevBlock=a.slice(d,d+x)}}),r.Decryptor=r.extend({processBlock:function(a,d){var c=this._cipher,x=c.blockSize,i=a.slice(d,d+x);n.call(this,a,d,x,c),this._prevBlock=i}});function n(a,d,c,x){var i,u=this._iv;u?(i=u.slice(0),this._iv=void 0):i=this._prevBlock,x.encryptBlock(i,0);for(var w=0;w<c;w++)a[d+w]^=i[w]}return r}(),t.mode.CFB})}(P0)),P0.exports}var T0={exports:{}},Ut;function dn(){return Ut||(Ut=1,function(s,e){(function(t,r,n){s.exports=r(G(),ie())})(U,function(t){return t.mode.CTR=function(){var r=t.lib.BlockCipherMode.extend(),n=r.Encryptor=r.extend({processBlock:function(a,d){var c=this._cipher,x=c.blockSize,i=this._iv,u=this._counter;i&&(u=this._counter=i.slice(0),this._iv=void 0);var w=u.slice(0);c.encryptBlock(w,0),u[x-1]=u[x-1]+1|0;for(var o=0;o<x;o++)a[d+o]^=w[o]}});return r.Decryptor=n,r}(),t.mode.CTR})}(T0)),T0.exports}var z0={exports:{}},$t;function xn(){return $t||($t=1,function(s,e){(function(t,r,n){s.exports=r(G(),ie())})(U,function(t){/** @preserve
 * Counter block mode compatible with  Dr Brian Gladman fileenc.c
 * derived from CryptoJS.mode.CTR
 * Jan Hruby jhruby.web@gmail.com
 */return t.mode.CTRGladman=function(){var r=t.lib.BlockCipherMode.extend();function n(c){if((c>>24&255)===255){var x=c>>16&255,i=c>>8&255,u=c&255;x===255?(x=0,i===255?(i=0,u===255?u=0:++u):++i):++x,c=0,c+=x<<16,c+=i<<8,c+=u}else c+=16777216;return c}function a(c){return(c[0]=n(c[0]))===0&&(c[1]=n(c[1])),c}var d=r.Encryptor=r.extend({processBlock:function(c,x){var i=this._cipher,u=i.blockSize,w=this._iv,o=this._counter;w&&(o=this._counter=w.slice(0),this._iv=void 0),a(o);var f=o.slice(0);i.encryptBlock(f,0);for(var l=0;l<u;l++)c[x+l]^=f[l]}});return r.Decryptor=d,r}(),t.mode.CTRGladman})}(z0)),z0.exports}var L0={exports:{}},Gt;function vn(){return Gt||(Gt=1,function(s,e){(function(t,r,n){s.exports=r(G(),ie())})(U,function(t){return t.mode.OFB=function(){var r=t.lib.BlockCipherMode.extend(),n=r.Encryptor=r.extend({processBlock:function(a,d){var c=this._cipher,x=c.blockSize,i=this._iv,u=this._keystream;i&&(u=this._keystream=i.slice(0),this._iv=void 0),c.encryptBlock(u,0);for(var w=0;w<x;w++)a[d+w]^=u[w]}});return r.Decryptor=n,r}(),t.mode.OFB})}(L0)),L0.exports}var q0={exports:{}},jt;function pn(){return jt||(jt=1,function(s,e){(function(t,r,n){s.exports=r(G(),ie())})(U,function(t){return t.mode.ECB=function(){var r=t.lib.BlockCipherMode.extend();return r.Encryptor=r.extend({processBlock:function(n,a){this._cipher.encryptBlock(n,a)}}),r.Decryptor=r.extend({processBlock:function(n,a){this._cipher.decryptBlock(n,a)}}),r}(),t.mode.ECB})}(q0)),q0.exports}var W0={exports:{}},Xt;function wn(){return Xt||(Xt=1,function(s,e){(function(t,r,n){s.exports=r(G(),ie())})(U,function(t){return t.pad.AnsiX923={pad:function(r,n){var a=r.sigBytes,d=n*4,c=d-a%d,x=a+c-1;r.clamp(),r.words[x>>>2]|=c<<24-x%4*8,r.sigBytes+=c},unpad:function(r){var n=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=n}},t.pad.Ansix923})}(W0)),W0.exports}var O0={exports:{}},Kt;function gn(){return Kt||(Kt=1,function(s,e){(function(t,r,n){s.exports=r(G(),ie())})(U,function(t){return t.pad.Iso10126={pad:function(r,n){var a=n*4,d=a-r.sigBytes%a;r.concat(t.lib.WordArray.random(d-1)).concat(t.lib.WordArray.create([d<<24],1))},unpad:function(r){var n=r.words[r.sigBytes-1>>>2]&255;r.sigBytes-=n}},t.pad.Iso10126})}(O0)),O0.exports}var F0={exports:{}},Vt;function bn(){return Vt||(Vt=1,function(s,e){(function(t,r,n){s.exports=r(G(),ie())})(U,function(t){return t.pad.Iso97971={pad:function(r,n){r.concat(t.lib.WordArray.create([2147483648],1)),t.pad.ZeroPadding.pad(r,n)},unpad:function(r){t.pad.ZeroPadding.unpad(r),r.sigBytes--}},t.pad.Iso97971})}(F0)),F0.exports}var I0={exports:{}},Yt;function mn(){return Yt||(Yt=1,function(s,e){(function(t,r,n){s.exports=r(G(),ie())})(U,function(t){return t.pad.ZeroPadding={pad:function(r,n){var a=n*4;r.clamp(),r.sigBytes+=a-(r.sigBytes%a||a)},unpad:function(r){for(var n=r.words,a=r.sigBytes-1,a=r.sigBytes-1;a>=0;a--)if(n[a>>>2]>>>24-a%4*8&255){r.sigBytes=a+1;break}}},t.pad.ZeroPadding})}(I0)),I0.exports}var N0={exports:{}},Zt;function yn(){return Zt||(Zt=1,function(s,e){(function(t,r,n){s.exports=r(G(),ie())})(U,function(t){return t.pad.NoPadding={pad:function(){},unpad:function(){}},t.pad.NoPadding})}(N0)),N0.exports}var M0={exports:{}},Qt;function _n(){return Qt||(Qt=1,function(s,e){(function(t,r,n){s.exports=r(G(),ie())})(U,function(t){return function(r){var n=t,a=n.lib,d=a.CipherParams,c=n.enc,x=c.Hex,i=n.format;i.Hex={stringify:function(u){return u.ciphertext.toString(x)},parse:function(u){var w=x.parse(u);return d.create({ciphertext:w})}}}(),t.format.Hex})}(M0)),M0.exports}var U0={exports:{}},Jt;function Cn(){return Jt||(Jt=1,function(s,e){(function(t,r,n){s.exports=r(G(),Oe(),Fe(),Te(),ie())})(U,function(t){return function(){var r=t,n=r.lib,a=n.BlockCipher,d=r.algo,c=[],x=[],i=[],u=[],w=[],o=[],f=[],l=[],h=[],v=[];(function(){for(var p=[],b=0;b<256;b++)b<128?p[b]=b<<1:p[b]=b<<1^283;for(var _=0,R=0,b=0;b<256;b++){var k=R^R<<1^R<<2^R<<3^R<<4;k=k>>>8^k&255^99,c[_]=k,x[k]=_;var S=p[_],T=p[S],m=p[T],C=p[k]*257^k*16843008;i[_]=C<<24|C>>>8,u[_]=C<<16|C>>>16,w[_]=C<<8|C>>>24,o[_]=C;var C=m*16843009^T*65537^S*257^_*16843008;f[k]=C<<24|C>>>8,l[k]=C<<16|C>>>16,h[k]=C<<8|C>>>24,v[k]=C,_?(_=S^p[p[p[m^S]]],R^=p[p[R]]):_=R=1}})();var y=[0,1,2,4,8,16,32,64,128,27,54],g=d.AES=a.extend({_doReset:function(){var p;if(!(this._nRounds&&this._keyPriorReset===this._key)){for(var b=this._keyPriorReset=this._key,_=b.words,R=b.sigBytes/4,k=this._nRounds=R+6,S=(k+1)*4,T=this._keySchedule=[],m=0;m<S;m++)m<R?T[m]=_[m]:(p=T[m-1],m%R?R>6&&m%R==4&&(p=c[p>>>24]<<24|c[p>>>16&255]<<16|c[p>>>8&255]<<8|c[p&255]):(p=p<<8|p>>>24,p=c[p>>>24]<<24|c[p>>>16&255]<<16|c[p>>>8&255]<<8|c[p&255],p^=y[m/R|0]<<24),T[m]=T[m-R]^p);for(var C=this._invKeySchedule=[],A=0;A<S;A++){var m=S-A;if(A%4)var p=T[m];else var p=T[m-4];A<4||m<=4?C[A]=p:C[A]=f[c[p>>>24]]^l[c[p>>>16&255]]^h[c[p>>>8&255]]^v[c[p&255]]}}},encryptBlock:function(p,b){this._doCryptBlock(p,b,this._keySchedule,i,u,w,o,c)},decryptBlock:function(p,b){var _=p[b+1];p[b+1]=p[b+3],p[b+3]=_,this._doCryptBlock(p,b,this._invKeySchedule,f,l,h,v,x);var _=p[b+1];p[b+1]=p[b+3],p[b+3]=_},_doCryptBlock:function(p,b,_,R,k,S,T,m){for(var C=this._nRounds,A=p[b]^_[0],B=p[b+1]^_[1],q=p[b+2]^_[2],W=p[b+3]^_[3],F=4,j=1;j<C;j++){var X=R[A>>>24]^k[B>>>16&255]^S[q>>>8&255]^T[W&255]^_[F++],V=R[B>>>24]^k[q>>>16&255]^S[W>>>8&255]^T[A&255]^_[F++],K=R[q>>>24]^k[W>>>16&255]^S[A>>>8&255]^T[B&255]^_[F++],E=R[W>>>24]^k[A>>>16&255]^S[B>>>8&255]^T[q&255]^_[F++];A=X,B=V,q=K,W=E}var X=(m[A>>>24]<<24|m[B>>>16&255]<<16|m[q>>>8&255]<<8|m[W&255])^_[F++],V=(m[B>>>24]<<24|m[q>>>16&255]<<16|m[W>>>8&255]<<8|m[A&255])^_[F++],K=(m[q>>>24]<<24|m[W>>>16&255]<<16|m[A>>>8&255]<<8|m[B&255])^_[F++],E=(m[W>>>24]<<24|m[A>>>16&255]<<16|m[B>>>8&255]<<8|m[q&255])^_[F++];p[b]=X,p[b+1]=V,p[b+2]=K,p[b+3]=E},keySize:256/32});r.AES=a._createHelper(g)}(),t.AES})}(U0)),U0.exports}var $0={exports:{}},er;function Rn(){return er||(er=1,function(s,e){(function(t,r,n){s.exports=r(G(),Oe(),Fe(),Te(),ie())})(U,function(t){return function(){var r=t,n=r.lib,a=n.WordArray,d=n.BlockCipher,c=r.algo,x=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],i=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],u=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],w=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],o=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],f=c.DES=d.extend({_doReset:function(){for(var y=this._key,g=y.words,p=[],b=0;b<56;b++){var _=x[b]-1;p[b]=g[_>>>5]>>>31-_%32&1}for(var R=this._subKeys=[],k=0;k<16;k++){for(var S=R[k]=[],T=u[k],b=0;b<24;b++)S[b/6|0]|=p[(i[b]-1+T)%28]<<31-b%6,S[4+(b/6|0)]|=p[28+(i[b+24]-1+T)%28]<<31-b%6;S[0]=S[0]<<1|S[0]>>>31;for(var b=1;b<7;b++)S[b]=S[b]>>>(b-1)*4+3;S[7]=S[7]<<5|S[7]>>>27}for(var m=this._invSubKeys=[],b=0;b<16;b++)m[b]=R[15-b]},encryptBlock:function(y,g){this._doCryptBlock(y,g,this._subKeys)},decryptBlock:function(y,g){this._doCryptBlock(y,g,this._invSubKeys)},_doCryptBlock:function(y,g,p){this._lBlock=y[g],this._rBlock=y[g+1],l.call(this,4,252645135),l.call(this,16,65535),h.call(this,2,858993459),h.call(this,8,16711935),l.call(this,1,1431655765);for(var b=0;b<16;b++){for(var _=p[b],R=this._lBlock,k=this._rBlock,S=0,T=0;T<8;T++)S|=w[T][((k^_[T])&o[T])>>>0];this._lBlock=k,this._rBlock=R^S}var m=this._lBlock;this._lBlock=this._rBlock,this._rBlock=m,l.call(this,1,1431655765),h.call(this,8,16711935),h.call(this,2,858993459),l.call(this,16,65535),l.call(this,4,252645135),y[g]=this._lBlock,y[g+1]=this._rBlock},keySize:64/32,ivSize:64/32,blockSize:64/32});function l(y,g){var p=(this._lBlock>>>y^this._rBlock)&g;this._rBlock^=p,this._lBlock^=p<<y}function h(y,g){var p=(this._rBlock>>>y^this._lBlock)&g;this._lBlock^=p,this._rBlock^=p<<y}r.DES=d._createHelper(f);var v=c.TripleDES=d.extend({_doReset:function(){var y=this._key,g=y.words;if(g.length!==2&&g.length!==4&&g.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var p=g.slice(0,2),b=g.length<4?g.slice(0,2):g.slice(2,4),_=g.length<6?g.slice(0,2):g.slice(4,6);this._des1=f.createEncryptor(a.create(p)),this._des2=f.createEncryptor(a.create(b)),this._des3=f.createEncryptor(a.create(_))},encryptBlock:function(y,g){this._des1.encryptBlock(y,g),this._des2.decryptBlock(y,g),this._des3.encryptBlock(y,g)},decryptBlock:function(y,g){this._des3.decryptBlock(y,g),this._des2.encryptBlock(y,g),this._des1.decryptBlock(y,g)},keySize:192/32,ivSize:64/32,blockSize:64/32});r.TripleDES=d._createHelper(v)}(),t.TripleDES})}($0)),$0.exports}var G0={exports:{}},tr;function kn(){return tr||(tr=1,function(s,e){(function(t,r,n){s.exports=r(G(),Oe(),Fe(),Te(),ie())})(U,function(t){return function(){var r=t,n=r.lib,a=n.StreamCipher,d=r.algo,c=d.RC4=a.extend({_doReset:function(){for(var u=this._key,w=u.words,o=u.sigBytes,f=this._S=[],l=0;l<256;l++)f[l]=l;for(var l=0,h=0;l<256;l++){var v=l%o,y=w[v>>>2]>>>24-v%4*8&255;h=(h+f[l]+y)%256;var g=f[l];f[l]=f[h],f[h]=g}this._i=this._j=0},_doProcessBlock:function(u,w){u[w]^=x.call(this)},keySize:256/32,ivSize:0});function x(){for(var u=this._S,w=this._i,o=this._j,f=0,l=0;l<4;l++){w=(w+1)%256,o=(o+u[w])%256;var h=u[w];u[w]=u[o],u[o]=h,f|=u[(u[w]+u[o])%256]<<24-l*8}return this._i=w,this._j=o,f}r.RC4=a._createHelper(c);var i=d.RC4Drop=c.extend({cfg:c.cfg.extend({drop:192}),_doReset:function(){c._doReset.call(this);for(var u=this.cfg.drop;u>0;u--)x.call(this)}});r.RC4Drop=a._createHelper(i)}(),t.RC4})}(G0)),G0.exports}var j0={exports:{}},rr;function Sn(){return rr||(rr=1,function(s,e){(function(t,r,n){s.exports=r(G(),Oe(),Fe(),Te(),ie())})(U,function(t){return function(){var r=t,n=r.lib,a=n.StreamCipher,d=r.algo,c=[],x=[],i=[],u=d.Rabbit=a.extend({_doReset:function(){for(var o=this._key.words,f=this.cfg.iv,l=0;l<4;l++)o[l]=(o[l]<<8|o[l]>>>24)&16711935|(o[l]<<24|o[l]>>>8)&4278255360;var h=this._X=[o[0],o[3]<<16|o[2]>>>16,o[1],o[0]<<16|o[3]>>>16,o[2],o[1]<<16|o[0]>>>16,o[3],o[2]<<16|o[1]>>>16],v=this._C=[o[2]<<16|o[2]>>>16,o[0]&4294901760|o[1]&65535,o[3]<<16|o[3]>>>16,o[1]&4294901760|o[2]&65535,o[0]<<16|o[0]>>>16,o[2]&4294901760|o[3]&65535,o[1]<<16|o[1]>>>16,o[3]&4294901760|o[0]&65535];this._b=0;for(var l=0;l<4;l++)w.call(this);for(var l=0;l<8;l++)v[l]^=h[l+4&7];if(f){var y=f.words,g=y[0],p=y[1],b=(g<<8|g>>>24)&16711935|(g<<24|g>>>8)&4278255360,_=(p<<8|p>>>24)&16711935|(p<<24|p>>>8)&4278255360,R=b>>>16|_&4294901760,k=_<<16|b&65535;v[0]^=b,v[1]^=R,v[2]^=_,v[3]^=k,v[4]^=b,v[5]^=R,v[6]^=_,v[7]^=k;for(var l=0;l<4;l++)w.call(this)}},_doProcessBlock:function(o,f){var l=this._X;w.call(this),c[0]=l[0]^l[5]>>>16^l[3]<<16,c[1]=l[2]^l[7]>>>16^l[5]<<16,c[2]=l[4]^l[1]>>>16^l[7]<<16,c[3]=l[6]^l[3]>>>16^l[1]<<16;for(var h=0;h<4;h++)c[h]=(c[h]<<8|c[h]>>>24)&16711935|(c[h]<<24|c[h]>>>8)&4278255360,o[f+h]^=c[h]},blockSize:128/32,ivSize:64/32});function w(){for(var o=this._X,f=this._C,l=0;l<8;l++)x[l]=f[l];f[0]=f[0]+1295307597+this._b|0,f[1]=f[1]+3545052371+(f[0]>>>0<x[0]>>>0?1:0)|0,f[2]=f[2]+886263092+(f[1]>>>0<x[1]>>>0?1:0)|0,f[3]=f[3]+1295307597+(f[2]>>>0<x[2]>>>0?1:0)|0,f[4]=f[4]+3545052371+(f[3]>>>0<x[3]>>>0?1:0)|0,f[5]=f[5]+886263092+(f[4]>>>0<x[4]>>>0?1:0)|0,f[6]=f[6]+1295307597+(f[5]>>>0<x[5]>>>0?1:0)|0,f[7]=f[7]+3545052371+(f[6]>>>0<x[6]>>>0?1:0)|0,this._b=f[7]>>>0<x[7]>>>0?1:0;for(var l=0;l<8;l++){var h=o[l]+f[l],v=h&65535,y=h>>>16,g=((v*v>>>17)+v*y>>>15)+y*y,p=((h&4294901760)*h|0)+((h&65535)*h|0);i[l]=g^p}o[0]=i[0]+(i[7]<<16|i[7]>>>16)+(i[6]<<16|i[6]>>>16)|0,o[1]=i[1]+(i[0]<<8|i[0]>>>24)+i[7]|0,o[2]=i[2]+(i[1]<<16|i[1]>>>16)+(i[0]<<16|i[0]>>>16)|0,o[3]=i[3]+(i[2]<<8|i[2]>>>24)+i[1]|0,o[4]=i[4]+(i[3]<<16|i[3]>>>16)+(i[2]<<16|i[2]>>>16)|0,o[5]=i[5]+(i[4]<<8|i[4]>>>24)+i[3]|0,o[6]=i[6]+(i[5]<<16|i[5]>>>16)+(i[4]<<16|i[4]>>>16)|0,o[7]=i[7]+(i[6]<<8|i[6]>>>24)+i[5]|0}r.Rabbit=a._createHelper(u)}(),t.Rabbit})}(j0)),j0.exports}var X0={exports:{}},nr;function Bn(){return nr||(nr=1,function(s,e){(function(t,r,n){s.exports=r(G(),Oe(),Fe(),Te(),ie())})(U,function(t){return function(){var r=t,n=r.lib,a=n.StreamCipher,d=r.algo,c=[],x=[],i=[],u=d.RabbitLegacy=a.extend({_doReset:function(){var o=this._key.words,f=this.cfg.iv,l=this._X=[o[0],o[3]<<16|o[2]>>>16,o[1],o[0]<<16|o[3]>>>16,o[2],o[1]<<16|o[0]>>>16,o[3],o[2]<<16|o[1]>>>16],h=this._C=[o[2]<<16|o[2]>>>16,o[0]&4294901760|o[1]&65535,o[3]<<16|o[3]>>>16,o[1]&4294901760|o[2]&65535,o[0]<<16|o[0]>>>16,o[2]&4294901760|o[3]&65535,o[1]<<16|o[1]>>>16,o[3]&4294901760|o[0]&65535];this._b=0;for(var v=0;v<4;v++)w.call(this);for(var v=0;v<8;v++)h[v]^=l[v+4&7];if(f){var y=f.words,g=y[0],p=y[1],b=(g<<8|g>>>24)&16711935|(g<<24|g>>>8)&4278255360,_=(p<<8|p>>>24)&16711935|(p<<24|p>>>8)&4278255360,R=b>>>16|_&4294901760,k=_<<16|b&65535;h[0]^=b,h[1]^=R,h[2]^=_,h[3]^=k,h[4]^=b,h[5]^=R,h[6]^=_,h[7]^=k;for(var v=0;v<4;v++)w.call(this)}},_doProcessBlock:function(o,f){var l=this._X;w.call(this),c[0]=l[0]^l[5]>>>16^l[3]<<16,c[1]=l[2]^l[7]>>>16^l[5]<<16,c[2]=l[4]^l[1]>>>16^l[7]<<16,c[3]=l[6]^l[3]>>>16^l[1]<<16;for(var h=0;h<4;h++)c[h]=(c[h]<<8|c[h]>>>24)&16711935|(c[h]<<24|c[h]>>>8)&4278255360,o[f+h]^=c[h]},blockSize:128/32,ivSize:64/32});function w(){for(var o=this._X,f=this._C,l=0;l<8;l++)x[l]=f[l];f[0]=f[0]+1295307597+this._b|0,f[1]=f[1]+3545052371+(f[0]>>>0<x[0]>>>0?1:0)|0,f[2]=f[2]+886263092+(f[1]>>>0<x[1]>>>0?1:0)|0,f[3]=f[3]+1295307597+(f[2]>>>0<x[2]>>>0?1:0)|0,f[4]=f[4]+3545052371+(f[3]>>>0<x[3]>>>0?1:0)|0,f[5]=f[5]+886263092+(f[4]>>>0<x[4]>>>0?1:0)|0,f[6]=f[6]+1295307597+(f[5]>>>0<x[5]>>>0?1:0)|0,f[7]=f[7]+3545052371+(f[6]>>>0<x[6]>>>0?1:0)|0,this._b=f[7]>>>0<x[7]>>>0?1:0;for(var l=0;l<8;l++){var h=o[l]+f[l],v=h&65535,y=h>>>16,g=((v*v>>>17)+v*y>>>15)+y*y,p=((h&4294901760)*h|0)+((h&65535)*h|0);i[l]=g^p}o[0]=i[0]+(i[7]<<16|i[7]>>>16)+(i[6]<<16|i[6]>>>16)|0,o[1]=i[1]+(i[0]<<8|i[0]>>>24)+i[7]|0,o[2]=i[2]+(i[1]<<16|i[1]>>>16)+(i[0]<<16|i[0]>>>16)|0,o[3]=i[3]+(i[2]<<8|i[2]>>>24)+i[1]|0,o[4]=i[4]+(i[3]<<16|i[3]>>>16)+(i[2]<<16|i[2]>>>16)|0,o[5]=i[5]+(i[4]<<8|i[4]>>>24)+i[3]|0,o[6]=i[6]+(i[5]<<16|i[5]>>>16)+(i[4]<<16|i[4]>>>16)|0,o[7]=i[7]+(i[6]<<8|i[6]>>>24)+i[5]|0}r.RabbitLegacy=a._createHelper(u)}(),t.RabbitLegacy})}(X0)),X0.exports}(function(s,e){(function(t,r,n){s.exports=r(G(),Ze(),nn(),sn(),Oe(),an(),Fe(),m0(),Ht(),on(),zt(),cn(),ln(),un(),E0(),fn(),Te(),ie(),hn(),dn(),xn(),vn(),pn(),wn(),gn(),bn(),mn(),yn(),_n(),Cn(),Rn(),kn(),Sn(),Bn())})(U,function(t){return t})})(yt);const sr=yt.exports;function En(s){let e=s.query?`${s.path}?${s.query}
`:`${s.path}
`;return s.body&&(e+=s.body),e}function K0(s){let e;try{e=new URL(s.path).pathname}catch(d){e=s.path}let t=En(me(ee({},s),{path:e}));const n=sr.HmacSHA1(t,s.appSalt).toString(sr.enc.Base64);let a=`QApp ${s.appID}:${n}`;return a=a.replace(/\//g,"_"),a=a.replace(/\+/g,"-"),a}const An=new URL(c0).hostname;function Dn(s,e,t){return z(this,null,function*(){var x;const n=wt({name:e,type:"A"}),a=K0({appID:t.appID,appSalt:t.appSalt,path:c0,query:n}),d=yield fetch(`${c0}?${n}`,{headers:{Authorization:a}});if(s.set("dnsResolveStatus",d.status),s.set("dnsResolveReqID",(x=d.headers.get("x-reqid"))!=null?x:""),s.set("dnsResolveConnectionAt",Date.now()),s.set("dnsResolveServiceDomain",An),!d.ok)throw new Error(`Call resolve API failed, status: ${d.status} ${d.statusText}`);return yield d.json()})}class Hn{constructor(e){this.logger=e}log(e){return this.logger.log("DnsResolveLog",e)}}function Pn(s,e){const t=new URLSearchParams(e).toString(),r=s.includes("?")?"&":"?";return s+r+t}function Me(){const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",e=s.length;let t="";for(let r=0;r<20;r++)t+=s[Math.floor(Math.random()*e)];return t}function ar(s,e){const t={};return Object.keys(s).forEach(r=>{t[r]=e(s[r])}),t}class or extends Error{constructor(){super(...arguments);L(this,"name","TimeoutError")}}function V0(s,e){return new Promise((t,r)=>{setTimeout(()=>r(new or(e+" timeout")),s)})}class Tn extends Error{constructor(){super(...arguments);L(this,"name","AbortError")}}function Y0(s){return new Promise((e,t)=>{s.aborted?t(s.reason):s.addEventListener("abort",()=>{t(s.reason)})})}function zn(s,e){e.aborted?s.abort(e.reason):e.addEventListener("abort",()=>{s.abort(e.reason)})}const ir={image:[/\.(jpe?g|png|gif|webp|svg|bmp|ico|tiff|avif|svga)$/],media:[/\.(3gp|aac|flac|mpe?g|mp3|mp4|m4a|m4v|m4p|oga|ogg|ogv|wav|webm|mov)$/],live:[/\.(flv|m3u8|ts|m4s)$/],other:[]};function Ln(s,e,t=["image","media","other"]){s.search="",s.hash="";const r=s.toString();return t.some(n=>{var a;return((a=e[n])!=null?a:[]).some(d=>d.test(r))})}function Qe(s){const e=new URL(s);return e.search="",e.hash="",e.toString()}function Ue(s){return s instanceof Error?{err_msg:s.name,err_desc:s.message}:{err_msg:"Unknown",err_desc:s+""}}function se(s,e){return s==null||s===-1||e==null||e===-1?-1:(s-e)/1e3}function cr(s,e=80){const[t,r]=s.split(":"),n=r?parseInt(r,10):e;return[t,n]}function lr(s){const e=s.split("/"),t=e[e.length-1],r=t.lastIndexOf(".");return r>=0?t.slice(r+1):""}function qn(s,e){return new URL(s,e).toString()}function Je(s){const[e]=s.split("?");return e.endsWith(".m3u8")}function ur(s){const[e]=s.split("?");return e.endsWith(".flv")}class fr{constructor(){L(this,"map",new Map)}on(e,t){var a;const n=[...(a=this.map.get(e))!=null?a:[],t];return this.map.set(e,n),()=>this.off(e,t)}once(e,t){const r=this.on(e,n=>{r(),t(n)});return r}off(e,t){var a;const n=((a=this.map.get(e))!=null?a:[]).filter(d=>d!==t);this.map.set(e,n)}emit(...e){var a;const[t,r]=e;((a=this.map.get(t))!=null?a:[]).forEach(d=>{d(r)})}dispose(){this.map.clear()}}function Wn(s){return z(this,null,function*(){const e=s.getReader();let t=new Uint8Array;for(;;){const{done:n,value:a}=yield e.read();if(n)break;t=new Uint8Array([...t,...a])}return new TextDecoder().decode(t)})}function e0(s,e){var d;const t=s.getReader(),r=(d=e[0])!=null?d:0,n=e[1];return new ReadableStream({start:c=>z(this,null,function*(){let x=0;for(;;){const{done:i,value:u}=yield t.read();if(i){c.close();break}const w=x+u.byteLength;if(w>r){let o=u;const f=r>x?r-x:0,l=n!=null&&n<w?n-x:void 0;if((f!==0||l!==void 0)&&(o=u.slice(f,l)),c.enqueue(o),n!=null&&w>=n){t.cancel("Cancelled by slice for target range met"),c.close();break}}x=w}}),cancel:c=>t.cancel(c)})}function On(s){let e=0;const t=new TransformStream({transform:(n,a)=>{e+=n.byteLength,a.enqueue(n)}}),r=s.pipeTo(t.writable).then(()=>({size:e,success:!0}),n=>({size:e,success:!1,error:n}));return[t.readable,r]}function Fn(s){let e,t=!1;const r=new ReadableStream({start:c=>{e=c},cancel:()=>{t=!0}}),n=s.getReader();let a=!1;return{main:new ReadableStream({start:c=>z(this,null,function*(){try{for(;;){const{value:x,done:i}=yield n.read();if(a)return;if(i){c.close(),t||e.close();return}c.enqueue(x),t||e.enqueue(x)}}catch(x){c.error(x),t||e.error(x)}}),cancel:c=>z(this,null,function*(){a=!0,yield n.cancel(c),e.error(c)})}),minor:r}}var Z0={exports:{}};(function(s,e){(function(t,r){var n="1.0.2",a="",d="?",c="function",x="undefined",i="object",u="string",w="major",o="model",f="name",l="type",h="vendor",v="version",y="architecture",g="console",p="mobile",b="tablet",_="smarttv",R="wearable",k="embedded",S=255,T="Amazon",m="Apple",C="ASUS",A="BlackBerry",B="Browser",q="Chrome",W="Edge",F="Firefox",j="Google",X="Huawei",V="LG",K="Microsoft",E="Motorola",H="Opera",P="Samsung",D="Sony",Q="Xiaomi",Y="Zebra",ce="Facebook",N=function(O,$){var M={};for(var re in O)$[re]&&$[re].length%2===0?M[re]=$[re].concat(O[re]):M[re]=O[re];return M},ge=function(O){for(var $={},M=0;M<O.length;M++)$[O[M].toUpperCase()]=O[M];return $},Re=function(O,$){return typeof O===u?ke($).indexOf(ke(O))!==-1:!1},ke=function(O){return O.toLowerCase()},ze=function(O){return typeof O===u?O.replace(/[^\d\.]/g,a).split(".")[0]:r},fe=function(O,$){if(typeof O===u)return O=O.replace(/^\s\s*/,a).replace(/\s\s*$/,a),typeof $===x?O:O.substring(0,S)},ae=function(O,$){for(var M=0,re,I,be,J,Ae,de;M<$.length&&!Ae;){var Se=$[M],De=$[M+1];for(re=I=0;re<Se.length&&!Ae;)if(Ae=Se[re++].exec(O),Ae)for(be=0;be<De.length;be++)de=Ae[++I],J=De[be],typeof J===i&&J.length>0?J.length===2?typeof J[1]==c?this[J[0]]=J[1].call(this,de):this[J[0]]=J[1]:J.length===3?typeof J[1]===c&&!(J[1].exec&&J[1].test)?this[J[0]]=de?J[1].call(this,de,J[2]):r:this[J[0]]=de?de.replace(J[1],J[2]):r:J.length===4&&(this[J[0]]=de?J[3].call(this,de.replace(J[1],J[2])):r):this[J]=de||r;M+=2}},Be=function(O,$){for(var M in $)if(typeof $[M]===i&&$[M].length>0){for(var re=0;re<$[M].length;re++)if(Re($[M][re],O))return M===d?r:M}else if(Re($[M],O))return M===d?r:M;return O},Le={"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"},qe={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},Ee={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[v,[f,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[v,[f,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[f,v],[/opios[\/ ]+([\w\.]+)/i],[v,[f,H+" Mini"]],[/\bopr\/([\w\.]+)/i],[v,[f,H]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[f,v],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[v,[f,"UC"+B]],[/\bqbcore\/([\w\.]+)/i],[v,[f,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[v,[f,"WeChat"]],[/konqueror\/([\w\.]+)/i],[v,[f,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[v,[f,"IE"]],[/yabrowser\/([\w\.]+)/i],[v,[f,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[f,/(.+)/,"$1 Secure "+B],v],[/\bfocus\/([\w\.]+)/i],[v,[f,F+" Focus"]],[/\bopt\/([\w\.]+)/i],[v,[f,H+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[v,[f,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[v,[f,"Dolphin"]],[/coast\/([\w\.]+)/i],[v,[f,H+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[v,[f,"MIUI "+B]],[/fxios\/([-\w\.]+)/i],[v,[f,F]],[/\bqihu|(qi?ho?o?|360)browser/i],[[f,"360 "+B]],[/(oculus|samsung|sailfish)browser\/([\w\.]+)/i],[[f,/(.+)/,"$1 "+B],v],[/(comodo_dragon)\/([\w\.]+)/i],[[f,/_/g," "],v],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[f,v],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i],[f],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[f,ce],v],[/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[f,v],[/\bgsa\/([\w\.]+) .*safari\//i],[v,[f,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[v,[f,q+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[f,q+" WebView"],v],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[v,[f,"Android "+B]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[f,v],[/version\/([\w\.]+) .*mobile\/\w+ (safari)/i],[v,[f,"Mobile Safari"]],[/version\/([\w\.]+) .*(mobile ?safari|safari)/i],[v,f],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[f,[v,Be,Le]],[/(webkit|khtml)\/([\w\.]+)/i],[f,v],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[f,"Netscape"],v],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[v,[f,F+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[f,v]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[y,"amd64"]],[/(ia32(?=;))/i],[[y,ke]],[/((?:i[346]|x)86)[;\)]/i],[[y,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[y,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[y,"armhf"]],[/windows (ce|mobile); ppc;/i],[[y,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[y,/ower/,a,ke]],[/(sun4\w)[;\)]/i],[[y,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[y,ke]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[pt]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[o,[h,P],[l,b]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[o,[h,P],[l,p]],[/\((ip(?:hone|od)[\w ]*);/i],[o,[h,m],[l,p]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[o,[h,m],[l,b]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[o,[h,X],[l,b]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}-[atu]?[ln][01259x][012359][an]?)\b(?!.+d\/s)/i],[o,[h,X],[l,p]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[o,/_/g," "],[h,Q],[l,p]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[o,/_/g," "],[h,Q],[l,b]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[o,[h,"OPPO"],[l,p]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[o,[h,"Vivo"],[l,p]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[o,[h,"Realme"],[l,p]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[o,[h,E],[l,p]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[o,[h,E],[l,b]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[o,[h,V],[l,b]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[o,[h,V],[l,p]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[o,[h,"Lenovo"],[l,b]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[o,/_/g," "],[h,"Nokia"],[l,p]],[/(pixel c)\b/i],[o,[h,j],[l,b]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[o,[h,j],[l,p]],[/droid.+ ([c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[o,[h,D],[l,p]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[o,"Xperia Tablet"],[h,D],[l,b]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[o,[h,"OnePlus"],[l,p]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[o,[h,T],[l,b]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[o,/(.+)/g,"Fire Phone $1"],[h,T],[l,p]],[/(playbook);[-\w\),; ]+(rim)/i],[o,h,[l,b]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[o,[h,A],[l,p]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[o,[h,C],[l,b]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[o,[h,C],[l,p]],[/(nexus 9)/i],[o,[h,"HTC"],[l,b]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic|sony)[-_ ]?([-\w]*)/i],[h,[o,/_/g," "],[l,p]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[o,[h,"Acer"],[l,b]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[o,[h,"Meizu"],[l,p]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[o,[h,"Sharp"],[l,p]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[h,o,[l,p]],[/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[h,o,[l,b]],[/(surface duo)/i],[o,[h,K],[l,b]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[o,[h,"Fairphone"],[l,p]],[/(u304aa)/i],[o,[h,"AT&T"],[l,p]],[/\bsie-(\w*)/i],[o,[h,"Siemens"],[l,p]],[/\b(rct\w+) b/i],[o,[h,"RCA"],[l,b]],[/\b(venue[\d ]{2,7}) b/i],[o,[h,"Dell"],[l,b]],[/\b(q(?:mv|ta)\w+) b/i],[o,[h,"Verizon"],[l,b]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[o,[h,"Barnes & Noble"],[l,b]],[/\b(tm\d{3}\w+) b/i],[o,[h,"NuVision"],[l,b]],[/\b(k88) b/i],[o,[h,"ZTE"],[l,b]],[/\b(nx\d{3}j) b/i],[o,[h,"ZTE"],[l,p]],[/\b(gen\d{3}) b.+49h/i],[o,[h,"Swiss"],[l,p]],[/\b(zur\d{3}) b/i],[o,[h,"Swiss"],[l,b]],[/\b((zeki)?tb.*\b) b/i],[o,[h,"Zeki"],[l,b]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[h,"Dragon Touch"],o,[l,b]],[/\b(ns-?\w{0,9}) b/i],[o,[h,"Insignia"],[l,b]],[/\b((nxa|next)-?\w{0,9}) b/i],[o,[h,"NextBook"],[l,b]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[h,"Voice"],o,[l,p]],[/\b(lvtel\-)?(v1[12]) b/i],[[h,"LvTel"],o,[l,p]],[/\b(ph-1) /i],[o,[h,"Essential"],[l,p]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[o,[h,"Envizen"],[l,b]],[/\b(trio[-\w\. ]+) b/i],[o,[h,"MachSpeed"],[l,b]],[/\btu_(1491) b/i],[o,[h,"Rotor"],[l,b]],[/(shield[\w ]+) b/i],[o,[h,"Nvidia"],[l,b]],[/(sprint) (\w+)/i],[h,o,[l,p]],[/(kin\.[onetw]{3})/i],[[o,/\./g," "],[h,K],[l,p]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[o,[h,Y],[l,b]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[o,[h,Y],[l,p]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[h,o,[l,g]],[/droid.+; (shield) bui/i],[o,[h,"Nvidia"],[l,g]],[/(playstation [345portablevi]+)/i],[o,[h,D],[l,g]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[o,[h,K],[l,g]],[/smart-tv.+(samsung)/i],[h,[l,_]],[/hbbtv.+maple;(\d+)/i],[[o,/^/,"SmartTV"],[h,P],[l,_]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[h,V],[l,_]],[/(apple) ?tv/i],[h,[o,m+" TV"],[l,_]],[/crkey/i],[[o,q+"cast"],[h,j],[l,_]],[/droid.+aft(\w)( bui|\))/i],[o,[h,T],[l,_]],[/\(dtv[\);].+(aquos)/i],[o,[h,"Sharp"],[l,_]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w ]*; *(\w[^;]*);([^;]*)/i],[[h,fe],[o,fe],[l,_]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[l,_]],[/((pebble))app/i],[h,o,[l,R]],[/droid.+; (glass) \d/i],[o,[h,j],[l,R]],[/droid.+; (wt63?0{2,3})\)/i],[o,[h,Y],[l,R]],[/(quest( 2)?)/i],[o,[h,ce],[l,R]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[h,[l,k]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[o,[l,p]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[o,[l,b]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[l,b]],[/(phone|mobile(?:[;\/]| safari)|pda(?=.+windows ce))/i],[[l,p]],[/(android[-\w\. ]{0,9});.+buil/i],[o,[h,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[v,[f,W+"HTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[v,[f,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[f,v],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[v,f]],os:[[/microsoft (windows) (vista|xp)/i],[f,v],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[f,[v,Be,qe]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[f,"Windows"],[v,Be,qe]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[v,/_/g,"."],[f,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[f,"Mac OS"],[v,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86)/i],[v,f],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[f,v],[/\(bb(10);/i],[v,[f,A]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[v,[f,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[v,[f,F+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[v,[f,"webOS"]],[/crkey\/([\d\.]+)/i],[v,[f,q+"cast"]],[/(cros) [\w]+ ([\w\.]+\w)/i],[[f,"Chromium OS"],v],[/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[f,v],[/(sunos) ?([\w\.\d]*)/i],[[f,"Solaris"],v],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[f,v]]},he=function(O,$){if(typeof O===i&&($=O,O=r),!(this instanceof he))return new he(O,$).getResult();var M=O||(typeof t!==x&&t.navigator&&t.navigator.userAgent?t.navigator.userAgent:a),re=$?N(Ee,$):Ee;return this.getBrowser=function(){var I={};return I[f]=r,I[v]=r,ae.call(I,M,re.browser),I.major=ze(I.version),I},this.getCPU=function(){var I={};return I[y]=r,ae.call(I,M,re.cpu),I},this.getDevice=function(){var I={};return I[h]=r,I[o]=r,I[l]=r,ae.call(I,M,re.device),I},this.getEngine=function(){var I={};return I[f]=r,I[v]=r,ae.call(I,M,re.engine),I},this.getOS=function(){var I={};return I[f]=r,I[v]=r,ae.call(I,M,re.os),I},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return M},this.setUA=function(I){return M=typeof I===u&&I.length>S?fe(I,S):I,this},this.setUA(M),this};he.VERSION=n,he.BROWSER=ge([f,v,w]),he.CPU=ge([y]),he.DEVICE=ge([o,h,l,g,p,_,b,R,k]),he.ENGINE=he.OS=ge([f,v]),s.exports&&(e=s.exports=he),e.UAParser=he;var pe=typeof t!==x&&(t.jQuery||t.Zepto);if(pe&&!pe.ua){var ue=new he;pe.ua=ue.getResult(),pe.ua.get=function(){return ue.getUA()},pe.ua.set=function(O){ue.setUA(O);var $=ue.getResult();for(var M in $)pe.ua[M]=$[M]}}})(typeof window=="object"?window:U)})(Z0,Z0.exports);const hr=Z0.exports;hr(navigator.userAgent);let $e;function Q0(){if($e!=null)return $e;try{new Response(new ReadableStream),$e=!0}catch(s){$e=!1}return $e}function t0(){return!(typeof TransformStream=="undefined"||!Q0())}class _e{constructor(e,{method:t,headers:r,signal:n,body:a}){L(this,"url");L(this,"method");L(this,"headers");L(this,"body");L(this,"signal");this.url=e,this.method=t!=null?t:"GET",this.headers=new Headers(r),this.body=a!=null?a:null,this.signal=n!=null?n:new AbortController().signal}}class Ce{constructor(e,{status:t,statusText:r,headers:n,underlayer:a}){L(this,"status");L(this,"statusText");L(this,"headers");L(this,"body");L(this,"bodyReadResult");L(this,"underlayer");if(this.status=t!=null?t:200,this.statusText=r!=null?r:"",this.headers=bt(n),this.underlayer=a,e==null||!t0())this.body=e,this.bodyReadResult=Promise.resolve({success:!0,size:0});else{const[d,c]=On(e);this.body=d,this.bodyReadResult=c}}}function r0(s){const{status:e,statusText:t,headers:r,body:n}=s;return new Ce(n,{status:e,statusText:t,headers:r,underlayer:s})}class dr extends Error{constructor(t){super(`Unexpected HTTP status: ${t.status} ${t.statusText}`);L(this,"name","UnexpectedHttpStatusError");this.response=t}}function xr(s){return s&&s.hoW===!0}function In(s){const e={};return s.forEach((t,r)=>{e[r]=t}),e}const Nn=new fr;let vr;typeof self!="undefined"&&(vr=self,vr.addEventListener("message",s=>Nn.emit("message",s)));class Mn extends Error{constructor(){super(...arguments);L(this,"name","WindowClientError")}}const Un="pR0mHGTJGIoVehu/AQCGTNeY",$n=8443,Gn=!0,ve=we("http/webrtc/how");class pr{constructor(e=1e4,t=3e3){L(this,"pcMap",new Map);this.pcConnectTimeout=e,this.dcOpenTimeout=t}makePc(e,t,r){return z(this,null,function*(){if(e.aborted)throw e.reason;const n=new RTCPeerConnection,a=n.createDataChannel("test"),d=yield n.createOffer();if(a.close(),d.sdp==null)throw new Error("TODO: empty sdp");d.sdp=d.sdp.replace(/a=ice-pwd:.+/,`a=ice-pwd:${Un}`),n.setLocalDescription(d);const[c,x]=cr(t,0),i=x+$n,u={type:"answer",sdp:jn(c,i,r,Gn)};return n.setRemoteDescription(u),yield Promise.race([Qn(e,n,t),V0(this.pcConnectTimeout,"PeerConnection connect")]).catch(w=>{throw n.close(),w}),n})}getPc(e,t,r){return z(this,null,function*(){if(this.pcMap.has(t)){const a=yield this.pcMap.get(t);if(a.connectionState==="connected")return a}const n=this.makePc(e,t,r);return this.pcMap.set(t,n),n.catch(a=>{this.pcMap.delete(t)}),n})}fetch(e,t,r,n){return z(this,null,function*(){ve("fetch",r.url,"with id",t);const a=new URL(r.url).host,d=yield this.getPc(r.signal,a,n);return e.set("hoWPeerConnectionConnectAt",Date.now()),yield new Yn(d,e,t,r,this.dcOpenTimeout).start()})}dispose(){this.pcMap.forEach(e=>e.then(t=>t.close())),this.pcMap.clear()}}function jn(s,e,t,r=!1){const n=r?`a=candidate:2932249642 1 tcp 2130706431 ${s} ${e} typ host tcptype passive`:`a=candidate:2932249642 1 udp 2130706431 ${s} ${e} typ host`,a=Me();return`v=0
o=- 4679586637491621141 1661250920 IN IP4 0.0.0.0
s=-
t=0 0
a=fingerprint:sha-256 ${t}
a=ice-lite
a=extmap-allow-mixed
a=group:BUNDLE 0
m=application 9 UDP/DTLS/SCTP webrtc-datachannel
c=IN IP4 0.0.0.0
a=setup:active
a=mid:0
a=sendrecv
a=sctp-port:5000
a=ice-ufrag:${a}
a=ice-pwd:uNjBwWiGCWkRpkmkjPtjAgqrUTpVqWaM
${n}
a=end-of-candidates
`}function Xn(s){const e=new URL(s.url),t={};s.headers.forEach((n,a)=>{t[a]=[n]});const r={method:s.method,target:e.pathname+e.search,version:"HTTP/1.1",header:t};return JSON.stringify(r)}function Kn(s){try{const e=JSON.parse(s);return!e.header&&e.Header&&(e.header=e.Header),e}catch(e){throw new Error("Invalid Response head")}}function Ge(s,e,t){return s.addEventListener(e,t),()=>s.removeEventListener(e,t)}function Vn(s,e,t){const r=[()=>{e.readyState!=="closing"&&e.readyState!=="closed"&&(ve(`close DataChannel ${s} for finish`),e.close())}];let n=!1;const a=d=>{n||(n=!0,r.forEach(c=>c()),r.length=0,d==null||d())};return new ReadableStream({start:d=>{Y0(t).catch(c=>{a(()=>d.error(c))}),r.push(Ge(e,"message",({data:c})=>{d.enqueue(c)})),r.push(Ge(e,"error",c=>{ve(`dc ${s} error`,c),a(()=>d.error(c))})),r.push(Ge(e,"closing",c=>{ve(`DataChannel ${s} closing`,c),a(()=>d.close())}))},cancel:d=>{a()}})}class Yn{constructor(e,t,r,n,a){L(this,"dc");L(this,"stream");this.ctx=t,this.id=r,this.request=n,this.dcOpenTimeout=a,this.dc=e.createDataChannel(`http|${r}`),this.stream=Vn(this.id,this.dc,n.signal)}open(){return z(this,null,function*(){if(this.dc.readyState==="open")return;const e=[],t=()=>e.forEach(n=>n()),r=new Promise((n,a)=>{e.push(Ge(this.dc,"open",()=>{ve(`DataChannel ${this.id} opened`),n()})),e.push(Ge(this.dc,"error",()=>{ve(`DataChannel ${this.id} error`),a(new Error("DataChannel error"))}))});return Promise.race([r,V0(this.dcOpenTimeout,`DataChannel ${this.id} open`),Y0(this.request.signal)]).finally(t)})}sendRequest(){return z(this,null,function*(){var n;const e=this.request;if(!["GET","HEAD"].includes(e.method))throw new Error(`TODO: Request with method ${e.method} is not supported`);if(parseInt((n=e.headers.get("Content-Length"))!=null?n:"0",10)>0)throw new Error("TODO: Request with body is not supported");const r=Xn(e);ve(`DataChannel ${this.id} sendRequest:`,r),this.dc.send(r)})}receiveResponse(){return z(this,null,function*(){var l;ve(`DataChannel ${this.id} receiveResponse with state: ${this.dc.readyState}`);const e=this.request,t=this.stream.getReader(),{value:r,done:n}=yield t.read();if(n)throw new wr(`Unexpected DataChannel close, resp head expected. id: ${this.id}, url: ${this.request.url}`);if(typeof r!="string")throw new gr(`Expected first message type to be string, while got ${typeof r}`);const a=Kn(r);ve(`DataChannel ${this.id} get respHead:`,a);const d=a.status,c=bt(ar((l=a.header)!=null?l:{},h=>h[0])),x={status:d,statusText:a.reason,headers:c},[i,u]=Qr(e.method,d,e.headers,c);if(this.ctx.set("hoWStartTransferAt",Date.now()),!i){const h=new Ce(null,x);return ve("DataChannel receiveResponse done with no body"),h}let w=0;const o=new ReadableStream({start:h=>{(()=>z(this,null,function*(){for(;;){const{value:v,done:y}=yield t.read();if(y){h.close();return}if(!(v instanceof ArrayBuffer))throw new Error(`Unexpected message type: ${typeof v} / ${v==null?void 0:v.constructor.name}`);if(v.byteLength===0){t.cancel("Empty message indicates resp end"),h.close();return}h.enqueue(new Uint8Array(v)),w+=v.byteLength,u!=null&&w>=u&&(t.cancel(`Body length (${u}) reached`),h.close())}}))().catch(v=>{h.error(v)})},cancel(h){ve("DataChannel bodyStream cancel:",h),t.cancel(h)}});return new Ce(o,x)})}start(){return z(this,null,function*(){yield this.open(),this.ctx.set("hoWDataChannelOpenAt",Date.now());const[,e]=yield Promise.all([this.sendRequest(),this.receiveResponse()]);return e})}}class wr extends Error{constructor(){super(...arguments);L(this,"name","UnexpectedDataChannelCloseError")}}class gr extends Error{constructor(){super(...arguments);L(this,"name","UnexpectedDataChannel1stMessageError")}}class Zn extends Error{constructor(){super(...arguments);L(this,"name","PeerConnectionDisconnectedError")}}function Qn(s,e,t){return new Promise((r,n)=>{if(e.connectionState==="connected"){r();return}const a=Jn(e,"connectionstatechange",()=>{if(ve(`RTCPeerConnection ${t} connectionstatechange`,e.connectionState),["failed","closed","disconnected"].includes(e.connectionState)){n(new Zn(`${t} ${e.connectionState}`)),a();return}if(e.connectionState==="connected"){r(),a();return}});Y0(s).catch(d=>{n(d),a()})})}function Jn(s,e,t){return s.addEventListener(e,t),()=>s.removeEventListener(e,t)}function br(s,e=()=>1){if(s.length===0)return null;const t=s.map(e),r=t.reduce((a,d)=>a+d,0);let n=Math.random()*r;for(let a=0;a<t.length;a++){const d=t[a];if(n<d)return s[a];n-=d}return s[0]}function J0(s){return s&&s.name==="AbortError"}const es=new wr().name,ts=new gr().name;function n0(s){return!(s&&[es,ts].includes(s.name)||J0(s)||s instanceof Mn)}class mr extends Error{constructor(t){super(t+"");L(this,"name","ResolveError");this.cause=t}}class yr extends Error{constructor(){super(...arguments);L(this,"name","NoAvailableNodeError")}}class _r extends Error{constructor(t){super(t+"");L(this,"name","DoWithNodeError");this.cause=t}}class je extends Error{constructor(){super(...arguments);L(this,"name","LocalDNSError")}}const Xe=we("dns");class rs{constructor(e,t,r=Dn){L(this,"cache",new Map);L(this,"logger");L(this,"fingerprints",new Map);this.app=t,this.dnsResolver=r,this.logger=new Hn(e)}getFingerprint(e){const t=this.fingerprints.get(e);if(t==null)throw new Error(`No fingerprint for ${e}`);return t}getResolveResult(e,t){return z(this,null,function*(){var c,x,i,u;const r=Date.now();let n,a;try{let w;try{w=yield this.dnsResolver(e,t,this.app)}catch(h){throw console.warn("DNS resolve failed:",h),new mr(h)}if(!as(w))throw new je(`Non-ECDN domain: ${t}`);if(w.groups.length===0)throw new yr(`No available group for ${t}`);const d=w,{groups:o}=d,f=Ve(d,["groups"]),l=[];return o.forEach(h=>{h.elts.forEach(y=>{y.ips.forEach(g=>{this.fingerprints.set(g,y.fingerprint)})});const v=new Pe;v.set(h.elts.map(y=>({key:y.id,replicas:y.replicas}))),l.push(me(ee({},h),{consistentHash:v}))}),a=me(ee({},f),{expireAt:Date.now()+w.ttl*1e3,groups:l}),a}catch(w){throw n=w,w}finally{const w=se(Date.now(),r),o=a==null?Ue(n):{err_msg:"",err_desc:""};this.logger.log(me(ee({r_id:(c=e.get("dnsResolveReqID"))!=null?c:"",ip:(x=e.get("dnsResolveServiceIP"))!=null?x:"",domain:(i=e.get("dnsResolveServiceDomain"))!=null?i:"",status_code:(u=e.get("dnsResolveStatus"))!=null?u:-1},o),{t_conn:se(e.get("dnsResolveConnectionAt"),r),t_total:w,type:1})),e.set("dnsResolveTotalTime",w)}})}resolveDomain(e,t){return z(this,null,function*(){const r=this.cache.get(t);if(r!=null){let a;try{a=yield r}catch(d){if(d instanceof je||d instanceof yr)throw d}if(a!=null&&a.expireAt>Date.now())return e.set("dnsResolveFromCache",!0),a;this.cache.delete(t)}const n=this.getResolveResult(e,t);return this.cache.set(t,n),n})}resolve(e,t,r=!1){return z(this,null,function*(){let n=null;return yield this.do(e,t,1,r,a=>{n=a}),n})}do(e,t,r,n,a){return z(this,null,function*(){const d=new URL(t);if(d.port!=="")throw new Error("TODO: no port");let c;Xe("Resolve for",t);let{groups:x}=yield this.resolveDomain(e,d.host);Xe("Resolved for",t);for(let i=0;i<r;i++){const u=br(x,w=>w.weight);if(u==null)break;try{Xe("doWithGroup",i,t),yield ns(u,t,n,a);return}catch(w){console.warn("doWithGroup (weight:",u.weight,") failed:",w,t),n0(w)&&(x=x.filter(o=>o!==u)),c=w}}throw c=J0(c)?c:new _r(c),c})}}function ns(s,e,t,r){return z(this,null,function*(){const n=s.elts;if(n.length===0)throw new Error("Empty elt list");if(!s.consistentHash)throw new Error("no consistentHash");const a=s.consistentHash.clone();let d;for(let c=0;c<2;c++){const x=a.get(e);if(x==null)break;const i=n.find(u=>u.id===x);if(i==null)throw new Error("No available elt");try{Xe("doWithElt",i.id,e),yield ss(i,e,t,r);return}catch(u){console.warn("doWithElt",i.id,"failed:",u,e),n0(u)&&a.remove(x),d=u}}throw d})}function ss(s,e,t,r){return z(this,null,function*(){let n=t?s.hosts:s.ips;if(n.length===0)throw new Error(`Empty ${t?"host":"IP"} list`);let a;for(let d=0;d<2;d++){const c=br(n);if(c==null)break;try{Xe(`do with ${t?"host":"IP"}`,c,e),yield r(c);return}catch(x){console.warn("do job with",c,"failed:",x,e),n0(x)&&(n=n.filter(i=>i!==c)),a=x}}throw a})}function as(s){return s.groups!=null}class os{constructor(e,t){L(this,"db");this.dbName=e,this.storeNames=t}getDB(){return z(this,null,function*(){return this.db!=null?this.db:new Promise(e=>{const t=indexedDB.open(this.dbName);t.addEventListener("upgradeneeded",()=>{this.storeNames.forEach(r=>{t.result.createObjectStore(r)})}),e(s0(t))})})}get(e,t){return z(this,null,function*(){const n=(yield this.getDB()).transaction(e,"readonly").objectStore(e).get(t);return s0(n)})}getAll(e){return z(this,null,function*(){const r=(yield this.getDB()).transaction(e,"readonly").objectStore(e).getAll();return s0(r)})}count(e){return z(this,null,function*(){const r=(yield this.getDB()).transaction(e,"readonly").objectStore(e).count();return s0(r)})}set(e,t,r){return z(this,null,function*(){const a=(yield this.getDB()).transaction(e,"readwrite");return a.objectStore(e).put(r,t),et(a)})}remove(e,t){return z(this,null,function*(){const n=(yield this.getDB()).transaction(e,"readwrite");return n.objectStore(e).delete(t),et(n)})}clear(){return z(this,null,function*(){const e=yield this.getDB();yield Promise.all(this.storeNames.map(t=>{const r=e.transaction(t,"readwrite");return r.objectStore(t).clear(),et(r)}))})}dispose(){var e;(e=this.db)==null||e.close()}}function s0(s){return new Promise((e,t)=>{s.addEventListener("success",()=>e(s.result)),s.addEventListener("error",()=>t(s.error))})}function et(s){return new Promise((e,t)=>{s.addEventListener("complete",()=>e()),s.addEventListener("error",()=>t(s.error)),s.addEventListener("abort",()=>t(s.error))})}const is=we("dc"),Cr="miku/dc",tt="item";class cs{constructor(e={}){L(this,"db",new os(Cr,[tt]));L(this,"browserCache",null);L(this,"browserCachePromise",null);this.config=e}openBrowserCache(){return z(this,null,function*(){return this.browserCachePromise!=null?this.browserCachePromise:(this.browserCachePromise=caches.open(Cr),this.browserCachePromise.then(e=>{this.browserCache=e}),this.browserCachePromise)})}getItem(e){return z(this,null,function*(){return this.db.get(tt,e)})}setItem(e,t){return z(this,null,function*(){is("setItem",e,t),yield this.db.set(tt,e,t)})}browserCacheMatch(e){return z(this,null,function*(){let t=this.browserCache;return t==null&&(t=yield this.openBrowserCache()),t.match(e)})}browserCachePut(e,t){return z(this,null,function*(){let r=this.browserCache;r==null&&(r=yield this.openBrowserCache()),yield r.put(e,t)})}getContent(e,t){return z(this,null,function*(){const r=yield this.browserCacheMatch(Rr(e,t));if(r==null)return;if(r.body==null)throw new Error("Body expected for cached response");return r0(r)})}setContent(e,t,r){return z(this,null,function*(){let n;if(!Q0())n=r.underlayer;else{const{headers:a,body:d}=r;n=new Response(d,{status:200,statusText:"OK",headers:a})}yield this.browserCachePut(Rr(e,t),n)})}dispose(){this.db.dispose()}}function Rr(s,e){var t;return`${s}_with_range_${e[0]}_${(t=e[1])!=null?t:""}`}class Ie{constructor(e){L(this,"value");this.value=e!=null?ee({},e.value):{}}set(e,t){this.value[e]=t}get(e){return this.value[e]}}class ls{constructor(e){this.logger=e}log(e){return this.logger.log("DownloadLog",e)}}class us{constructor(e){this.logger=e}log(e){return this.logger.log("DoLog",e)}}const kr="0.10.0",fs=3,rt=we("http");class Sr{constructor(e,t,r=0){L(this,"downloadLogger");L(this,"doLogger");this.client=t,this.clientResponseTimeout=r,this.downloadLogger=new ls(e),this.doLogger=new us(e)}doWithResolved(e,t,r,n){return z(this,null,function*(){var i;const a=new URL(t.url).host,d=Date.now();let c,x;try{rt("fetch",t.url,"with resolved",r);const u=new AbortController;zn(u,t.signal);const w=new _e(t.url,me(ee({},t),{signal:u.signal}));w.headers.set("X-Miku-Agent",`web-miku/v${kr}`);let o=this.client.fetch(e,w,r);this.clientResponseTimeout>0&&(o=Promise.race([o,V0(this.clientResponseTimeout)]),o.catch(l=>{l instanceof or&&u.abort(l)}));const f=yield o;if(rt("fetch",t.url,"succeeded with status",f.status),e.set("downloadStatus",f.status),e.set("downloadReqID",(i=f.headers.get("x-reqid"))!=null?i:""),f.status===429||f.status>=500)throw new dr(f);return x=f,x}catch(u){throw rt("fetch",t.url,"with resolved",r,"failed:",u),c=u,u}finally{const u=t.headers.get("Range"),w=u==null?null:pt(u),o=e.get("downloadReqMessageAt"),f=e.get("downloadConnectionAt"),l=e.get("downloadStartTransferAt"),h=e.get("downloadRespMessageAt"),v=p=>{var b,_,R,k,S,T,m;return this.downloadLogger.log(ee({ip:r.split(":")[0],domain:a,range_st:(b=w==null?void 0:w.start)!=null?b:-1,range_end:(_=w==null?void 0:w.end)!=null?_:-1,retry:n,ftask_id:(R=e.get("downloadFileTaskID"))!=null?R:"",task_id:(k=e.get("taskID"))!=null?k:"",d_id:(S=e.get("doID"))!=null?S:"",ts_st:d,r_id:(T=e.get("downloadReqID"))!=null?T:"",status_code:(m=e.get("downloadStatus"))!=null?m:-1,t_req_msg:se(o,d),t_conn:se(f,o!=null?o:d),t_tls:-1,t_st_trans:se(l,f),t_resp_msg:se(h,l),err_msg:"",err_desc:"",t_content_trans:-1,t_total:-1,resp_size:-1},p))},y=p=>{const b=Date.now();v(ee({t_total:se(b,d)},Ue(p)))},g=p=>{const b=Date.now();v({t_content_trans:se(b,h!=null?h:l),t_total:se(b,d),resp_size:p})};x==null?y(c):x.bodyReadResult.then(p=>{p.success?g(p.size):y(p.error)})}})}originalDo(e,t){return z(this,null,function*(){if(t.signal.aborted)throw t.signal.reason;let r=-1,n;if(yield this.client.resolve(e,t,fs,a=>z(this,null,function*(){r++;const d=new Ie(e);n=yield this.doWithResolved(d,t,a,r)})),n==null)throw new Error(`Http do failed: resolver do finished with no finalResp, url: ${t.url}`);return n})}do(e,t){return z(this,null,function*(){const r=Date.now(),n=Me();e.set("doID",n);let a,d=null;try{return a=yield this.originalDo(e,t),a}catch(c){throw d=c,c}finally{const{onDoError:c,onDoResponsed:x}=this.getDoLog(e,n,r);a==null?c(d):x(a.status)}})}getDoLog(e,t,r){const n=c=>{var x;return this.doLogger.log(ee({lookup_type:!0,t_lookup:(x=e.get("dnsResolveFromCache")===!0?0:e.get("dnsResolveTotalTime"))!=null?x:-1,t_total:-1,ts_st:r,err_desc:"",err_msg:"",status_code:-1,task_id:e.get("taskID"),id:t},c))};return{onDoError:c=>{const x=Date.now();n(ee({t_total:se(x,r)},Ue(c)))},onDoResponsed:c=>{const x=Date.now();n({t_total:se(x,r),status_code:c})}}}}function hs(s,e){return new Request(s,ee({mode:"cors",credentials:"omit"},e))}function Br(s,e){return z(this,null,function*(){const d=e,{url:t}=d,r=Ve(d,["url"]),n=hs(t,r),a=yield fetch(n);return r0(a)})}class ds{constructor(e){this.logger=e}log(e){return this.logger.log("TaskLog",e)}}class Er{constructor(e,t,r,n,a){L(this,"id",Me());L(this,"priority",0);L(this,"abortCtrl",new AbortController);L(this,"taskLogger");L(this,"started",!1);this.url=e,this.range=t,this.expiry=r,this.startByClient=a,this.taskLogger=new ds(n)}get signal(){return this.abortCtrl.signal}setPriority(e){this.priority=e}start(){return z(this,null,function*(){if(this.started)throw new Error("Task already started");this.started=!0;const e=Date.now(),t=new Ie;t.set("taskID",this.id);let r,n=null;try{return r=yield this.startByClient(t,this),r}catch(a){throw n=a,a}finally{const{logOnError:a,logOnTransfered:d}=this.log(t,e);r==null?a(n):r.underlayer.bodyReadResult.then(c=>{c.success?d():a(c.error)})}})}log(e,t){const r=e.get("taskCacheMatchAt"),n=e.get("task1stHttpDoAt"),a=e.get("taskResultStreamAt"),d=Date.now(),c=u=>{var w,o,f,l,h;return this.taskLogger.log(ee({type:(w=e.get("taskType"))!=null?w:1,id:this.id,url:this.url,err_msg:"",err_desc:"",range_st:(f=(o=this.range)==null?void 0:o.start)!=null?f:-1,range_end:(h=(l=this.range)==null?void 0:l.end)!=null?h:-1,ts_st:t,t_cc_match:se(r,t),t_http_do:se(n,r),t_res_stream:se(a,r),t_res:se(d,a),t_trans:-1,t_total:-1},u))};return{logOnError:u=>{const w=Date.now();c(ee({t_total:se(w,t)},Ue(u)))},logOnTransfered:()=>{const u=Date.now();c({t_trans:se(u,d),t_total:se(u,t)})}}}cancel(e){this.abortCtrl.abort(e)}}class Ar{constructor(e,t,r,n,a){this.stream=e,this.size=t,this.fileSize=r,this.contentType=n,this.underlayer=a}blob(){return z(this,null,function*(){const t=this.stream.getReader(),r=[];for(;;){const{done:n,value:a}=yield t.read();if(n)break;const d=a;r.push(d)}return new Blob(r)})}}function nt(s,e,t){return s!=null&&t!=null&&t>=s&&(t=null),(e==null||e<0)&&(e=0),[e,t]}function Dr(s,e){var n;const t=((n=e[0])!=null?n:0)===0,r=e[1]==null||s!=null&&e[1]===s;return t&&r}function xs(s,e){var n,a;const t=(n=e[0])!=null?n:0,r=(a=e[1])!=null?a:s;return r==null?null:r-t}function vs(s,e,t){var x,i;if(e===0)return[];const r=(u,w)=>gs(u,w,e!=null?e:Number.POSITIVE_INFINITY),n=(x=s==null?void 0:s[0])!=null?x:0,a=(i=s==null?void 0:s[1])!=null?i:e,d=[];let c=n;for(const u of t){if(c==null||e!=null&&u[1]!=null&&u[1]>e)break;if(!(u[1]!=null&&c>=u[1])){if(a==null||a>u[0]){u[0]>c&&d.push({cached:!1,range:nt(e,c,u[0])});const w=r(u[0],c)?u[0]:c,o=r(u[1],a)?a:u[1];r(o,w)&&(d.push({cached:!0,range:nt(e,w,o)}),c=o);continue}break}}return r(a,c)&&d.push({cached:!1,range:nt(e,c,a)}),d}function ps(s,e){var n;const t=(n=e[0])!=null?n:0,r=e[1];for(const a of s){if(a[1]!=null&&a[1]<=t)continue;if(a[0]>t)break;const d=t-a[0],c=bs(r!=null?r:a[1],a[0]);return{piece:a,start:d,end:c}}throw new Error("Piece not found")}function ws(s,e){return[...s,e].sort((t,r)=>t[0]-r[0])}function gs(s,e,t){const r=s!=null?s:t,n=e!=null?e:t;return r>n}function bs(s,e){return s==null||e==null?null:s-e}const ms={threshold:1024*1024*2,contentRangeExposed:!0},oe=we("ftask");class ys{constructor(e,t,r,n,a,d){L(this,"id",Me());L(this,"inited");L(this,"cachePieces",[]);L(this,"meta",null);this.cache=e,this.http=t,this.key=r,this.url=n,this.patterns=a,this.mediaOptimization=d,this.inited=this.resume()}startTask(e,t){return z(this,null,function*(){var c;oe("startTask",t.url);let r;const n=t.range!=null?[t.range.start,t.range.end]:[0,null];if(t0())r=yield this.readRangeByPieces(e,t,n);else{oe("supportStreamOperation: false",t.url,t.id);const x=[(c=n[0])!=null?c:0,n[1]],i=yield this.cache.getContent(this.key,x);e.set("taskCacheMatchAt",Date.now()),i!=null?(oe("use cache",t.url,t.id),r=i):(oe("doRequestAndSaveCache",t.url,t.id),r=yield this.doRequestAndSaveCache(e,t,n)),e.set("taskResultStreamAt",Date.now())}yield this.inited;const a=this.meta;if(a==null)throw new Error("Missing meta in fileTask");oe("startTask resolved",t.url,t.id);const d=xs(a.fsize,n);return new Ar(r.body,d,a.fsize,a.contentType,r)})}readRangeByPieces(e,t,r){return z(this,null,function*(){var c,x,i,u;yield this.inited;const n=vs(r,(x=(c=this.meta)==null?void 0:c.fsize)!=null?x:null,this.cachePieces);oe("applyRange",r,(u=(i=this.meta)==null?void 0:i.fsize)!=null?u:null,this.cachePieces,n),e.set("taskCacheMatchAt",Date.now());const a=new TransformStream(void 0),d=yield new Promise((w,o)=>z(this,null,function*(){try{for(let f=0;f<n.length;f++){const{cached:l,range:h}=n[f],v=yield l?this.readPieceFromLocal(e,t,h):this.readPieceFromRemote(e,t,h);f===0&&w(v);const g=f===n.length-1;yield v.body.pipeTo(a.writable,{preventClose:!g})}}catch(f){f!=null&&console.warn("readRange stream error for",this.url,f),a.writable.abort(f),o(f)}}));return e.set("taskResultStreamAt",Date.now()),new Ce(a.readable,d)})}readPieceFromLocal(e,t,r){return z(this,null,function*(){oe("readPieceFromLocal",t.url,r);const{piece:n,start:a,end:d}=ps(this.cachePieces,r),c=yield this.cache.getContent(this.key,n);return c==null?(console.warn(`Missing cache item: ${this.key} [${n})`),this.readPieceFromRemote(e,t,r)):new Ce(e0(c.body,[a,d]),c)})}fileSize(){var e,t;return(t=(e=this.meta)==null?void 0:e.fsize)!=null?t:null}readPieceFromRemote(e,t,r){return z(this,null,function*(){oe("readPieceFromRemote",t.url,r);const n=yield this.doRequestAndSaveCache(e,t,r);return!Dr(this.fileSize(),r)&&n.status===200?(console.warn("Range request not supported for",this.url),new Ce(e0(n.body,r),n)):n})}doRequest(e,t,r){return z(this,null,function*(){const n=new Ie(e);n.set("downloadFileTaskID",this.id);const a={"Accept-Encoding":"identity;q=1, *;q=0"};r!=null&&(t.range==null&&Dr(this.fileSize(),r)||(a.Range=f0({start:r[0],end:r[1]==null?null:r[1]-1})));const d=new _e(this.url,{method:"GET",headers:a,signal:t.signal});let c;if(!t0()||this.mediaOptimization.threshold<=0?c=yield this.http.do(n,d):c=yield _s((...x)=>this.http.do(...x),Br,this.mediaOptimization,this.patterns)(n,d),c.body==null)throw new Error("Body expected");if(c.status!==200&&c.status!==206)throw new dr(c);return this.saveMeta(c),c.bodyReadResult.then(x=>{oe(`bodyReadResult for ${this.url}:`,x)}),c})}doRequestAndSaveCache(e,t,r){return z(this,null,function*(){e.get("task1stHttpDoAt")==null&&e.set("task1stHttpDoAt",Date.now());const n=yield this.doRequest(e,t,r);return this.saveCachePiece(t,r,n)})}saveCachePiece(e,t,r){return z(this,null,function*(){var d,c;let n=r,a;if(t0()){const{main:x,minor:i}=Fn(r.body);n=new Ce(x,r),a=new Ce(i,r)}else if(!e.range){const x=r.underlayer.clone();a=r0(x)}if(a!=null){const x=[(d=t==null?void 0:t[0])!=null?d:0,(c=t==null?void 0:t[1])!=null?c:null];oe("saveCachePiece",this.url,x),this.cache.setContent(this.key,x,a).then(()=>(this.cachePieces=ws(this.cachePieces,x),this.save())).then(()=>oe("saveCachePiece finish",this.url,x),i=>oe("saveCachePiece failed",this.url,i))}return n})}saveMeta(e){return z(this,null,function*(){this.meta={contentType:e.headers.get("Content-Type"),fsize:mt(e)},yield this.save()})}resume(){return z(this,null,function*(){const e=yield this.cache.getItem(this.key);e==null||e.meta==null||(this.meta=e.meta,this.cachePieces=e.pieces)})}save(){return z(this,null,function*(){const e={meta:this.meta,pieces:this.cachePieces};yield this.cache.setItem(this.key,e)})}}function _s(s,e,{threshold:t,contentRangeExposed:r},n){return function(d,c){return z(this,null,function*(){var k,S;const R=c,{url:x}=R,i=Ve(R,["url"]),u=Qe(x);if(c.method!=="GET"||!n.media.some(m=>m.test(u)))return s(d,c);oe("doWithInitialOptimization",x);const w=new Ie(d),o=new _e(x,i),l=yield((m,C)=>z(this,null,function*(){var W;let A=null;const B=xt(C.headers);B!=null&&!vt(B)&&!r&&(A=Cs(x,i.headers,e));const q=yield e(m,C);if(B!=null&&q.status===206&&!q.headers.get("Content-Range")){const F=vt(B)?Ye(q.headers):yield A;if(F!=null){const j=Zr({start:B.start,end:(W=B.end)!=null?W:F-1,totalSize:F});q.headers.set("Content-Range",j)}}return q}))(w,o),h=Ye(l.headers);if(h!=null&&h<=t)return l;const v=new Headers(i.headers),y=(k=xt(v))!=null?k:{start:null,end:null};if(y.start=((S=y.start)!=null?S:0)+t,y.end!=null&&y.end<y.start)return l;oe("doWithInitialOptimization followingRange",y),v.set("Range",f0(y));const g=new _e(x,me(ee({},i),{headers:v})),T=l,{body:p}=T,b=Ve(T,["body"]),_=new TransformStream;if(p==null)throw new Error(`Body expected for initial response of ${x}`);return e0(p,[0,t]).pipeTo(_.writable,{preventClose:!0}).then(()=>z(this,null,function*(){oe("doWithInitialOptimization initialBody transfered");const m=yield s(d,g);if(m.body==null)throw new Error(`Body expected for following response of ${x}`);(m.status===206?m.body:e0(m.body,[y.start,y.end==null?null:y.end+1])).pipeTo(_.writable).then(()=>oe("doWithInitialOptimization followingBody transfered"),A=>oe("doWithInitialOptimization followingBody transfer errored",A))}),m=>z(this,null,function*(){oe("doWithInitialOptimization initialBody transfer errored",m)})),new Ce(_.readable,b)})}}function Cs(s,e,t){return z(this,null,function*(){const r=new Headers(e);r.delete("Range");const n=yield t(new Ie,new _e(s,{method:"HEAD",headers:r}));return Ye(n.headers)})}class Rs{constructor(){L(this,"locked",!1);L(this,"waitings",[]);this.unlock=this.unlock.bind(this)}lock(){return z(this,null,function*(){return this.locked?(yield new Promise(e=>{this.waitings.push(e)}),this.unlock):(this.locked=!0,this.unlock)})}unlock(){if(this.waitings.length===0){this.locked=!1;return}this.waitings.shift()()}runExclusive(e){return z(this,null,function*(){const t=yield this.lock();try{return yield e()}catch(r){throw r}finally{t()}})}}function ks(){var n,a;const{os:s,device:e,browser:t}=hr(navigator.userAgent);let r;return typeof window!="undefined"?r=window.location:typeof self!==void 0&&(r=self.location),{os:`${s.name}_${s.version}`,browser:`${t.name}_${t.version}`,app:(n=r==null?void 0:r.host)!=null?n:"",sdk:`Web SDK v${kr}`,dev_model:(a=e.model)!=null?a:"",dev_id:""}}const st=200,at=we("log");class Ss{constructor(e,t,r,n,a){L(this,"env",wt(ks()));L(this,"flushMutex",new Rs);L(this,"buffer",[]);this.schemaName=e,this.fetch=t,this.flushNum=r,this.flushWait=n,this.app=a}callApiLog(e){return z(this,null,function*(){const t=this.fetch;try{const r=K0({appID:this.app.appID,appSalt:this.app.appSalt,path:`${dt}/v1/log/${this.schemaName}`}),n=yield t(new Request(`${dt}/v1/log/${this.schemaName}`,{method:"POST",headers:{Authorization:r,"Content-Type":"text/csv","X-Env":this.env},body:Es(e)}));if(!n.ok)throw new Error(`Unexpected response status: ${n.status} ${n.statusText}`)}catch(r){console.warn("Call log API failed:",r)}})}flush(){return z(this,null,function*(){return this.flushMutex.runExclusive(()=>z(this,null,function*(){const e=this.buffer.splice(0);if(e.length===0)return;const t=Math.ceil(e.length/st);return Promise.all(Array.from({length:t}).map((r,n)=>this.callApiLog(e.slice(n*st,(n+1)*st))))}))})}tryFlush(){return z(this,null,function*(){const e=yield this.flushMutex.runExclusive(()=>{const t=this.buffer;if(t.length===0)return!1;if(t.length>=this.flushNum)return at("buffer.length >= this.flushNum"),!0;const r=Date.now()-t[0].ts;return r>=this.flushWait*1e3?(at("waited >= this.flushWait"),!0):this.flushWait*1e3-r});if(e===!0)return this.flush();typeof e=="number"&&setTimeout(()=>this.tryFlush(),e)})}log(e){this.buffer.push(ee({ts:Date.now()},e)),this.tryFlush()}}class Bs{constructor(e,t=self.fetch,r=100,n=30){L(this,"schemaLoggers",new Map);this.appInfo=e,this.fetch=t,this.flushNum=r,this.flushWait=n}log(e,t){at("log",e,t);let r=this.schemaLoggers.get(e);r==null&&(r=new Ss(e,this.fetch,this.flushNum,this.flushWait,this.appInfo),this.schemaLoggers.set(e,r)),r.log(t)}}function Es(s){const e=Object.keys(s[0]),t=["ts",...e.filter(a=>a!=="ts")],r=t.map(Hr).join(","),n=s.map(a=>t.map(d=>a[d]).map(d=>d!=null?d+"":"").map(Hr).join(","));return[r,...n].join(`
`)}function Hr(s){let e=s.replace(/"/g,'""');return/("|,|\n)/.test(e)&&(e='"'+e+'"'),e}const ot=we("http/webrtc/service");class As{constructor(e,t){L(this,"workerContainer",navigator.serviceWorker);L(this,"hoW");L(this,"abortCtrls",new Map);L(this,"disposers",[]);this.hoW=new pr(e,t),this.disposers.push(()=>this.hoW.dispose())}get worker(){if(this.workerContainer.controller==null)throw new Error("No available service worker");return this.workerContainer.controller}sendBody(e,t){return z(this,null,function*(){const r=t.getReader();for(;;){const{value:n,done:a}=yield r.read();if(a){const c={hoW:!0,type:"resp-body-chunk",id:e,payload:null};this.worker.postMessage(c);return}const d={hoW:!0,type:"resp-body-chunk",id:e,payload:n.buffer};this.worker.postMessage(d,[n.buffer])}})}sendResponse(e,t,r){return z(this,null,function*(){var i,u,w,o;ot("sendResponse in window",t,r);const{status:n,statusText:a,headers:d,body:c}=r,x={hoW:!0,type:"resp-head",id:t,status:n,statusText:a,headers:In(d),hasBody:c!=null,reqMessageAt:(i=e.get("hoWReqMessageAt"))!=null?i:-1,peerConnectionConnectAt:(u=e.get("hoWPeerConnectionConnectAt"))!=null?u:-1,dataChannelOpenAt:(w=e.get("hoWDataChannelOpenAt"))!=null?w:-1,startTransferAt:(o=e.get("hoWStartTransferAt"))!=null?o:-1};this.worker.postMessage(x),c!=null&&(yield this.sendBody(t,c)),ot("sendResponse finished in window",t,r)})}sendResponseError(e,t){const r={hoW:!0,type:"resp-error",id:e,name:t instanceof Error?t.name:"UnknownError",message:t instanceof Error?t.message:t+""};this.worker.postMessage(r)}receiveRequestBody(e){let t;const r=new ReadableStream({start:a=>t=a}),n=Pr(this.workerContainer,"message",({data:a})=>{if(!!xr(a)&&a.id===e&&a.type==="req-body-chunk"){if(t==null)throw new Error("Stream Controller should be ready");if(a.payload==null){t.close(),n();return}t.enqueue(new Uint8Array(a.payload))}});return r}getRequest({id:e,url:t,method:r,headers:n,hasBody:a}){const d=new AbortController;if(this.abortCtrls.set(e,d),!a)return new _e(t,{method:r,headers:n,signal:d.signal});const c=this.receiveRequestBody(e);return new _e(t,{method:r,headers:n,signal:d.signal,body:c})}run(){this.disposers.push(Pr(this.workerContainer,"message",t=>z(this,[t],function*({data:e}){var r;if(ot("Got message in window",e),!!xr(e)){if(e.type==="req-head"){const{id:n,fingerprint:a}=e,d=this.getRequest(e),c=new Ie;c.set("hoWReqMessageAt",Date.now());try{const x=yield this.hoW.fetch(c,n,d,a);yield this.sendResponse(c,n,x)}catch(x){this.sendResponseError(n,x)}finally{this.abortCtrls.delete(n)}return}if(e.type==="req-abort"){(r=this.abortCtrls.get(e.id))==null||r.abort(new Tn(e.reason));return}}})))}dispose(){this.disposers.forEach(e=>e())}}function Pr(s,e,t){return s.addEventListener(e,t),()=>s.removeEventListener(e,t)}const Tr=we("utils/taskq");class Ds{constructor(e){L(this,"tasks",[]);L(this,"emitter",new fr);L(this,"running",!0);for(let t=0;t<e;t++)this.comsumeLoop()}add(e){let t=0;for(;t<this.tasks.length&&!(this.tasks[t].priority>=e.priority);t++);this.tasks.splice(t,0,e),this.emitter.emit("task")}pop(){return z(this,null,function*(){const e=this.tasks.pop();return e!=null?e:new Promise(t=>{const r=this.emitter.on("task",()=>{const n=this.tasks.pop();n!=null&&(t(n),r())})})})}consumeTask(){return z(this,null,function*(){if(!this.running)return;const e=yield this.pop();Tr("run task",e.name,", with priority:",e.priority);try{yield e==null?void 0:e.run()}catch(t){console.warn("Task run failed:",t)}finally{Tr("end task",e.name)}})}comsumeLoop(){return z(this,null,function*(){for(;this.running;)yield this.consumeTask()})}dispose(){this.emitter.dispose(),this.running=!1}}const zr=10;class Hs{constructor(e,t){L(this,"taskq");this.resolver=e,this.taskq=new Ds(t!=null?t:zr)}getFingerprint(e){return this.resolver.getFingerprint(e)}resolve(e,t,r,n){return this.resolver.do(e,t.url,r,!1,n)}fetch(e,t,r){return z(this,null,function*(){return new Promise(n=>this.taskq.add({name:t.url,priority:0,run:()=>z(this,null,function*(){const a=Ps(t,r),d=this._fetch(e,a);n(d),yield(yield d).bodyReadResult})}))})}}function Ps(s,e){const{url:t,method:r,headers:n,signal:a,body:d}=s,c=new URL(t),x=c.host;c.host=e;const i=new Headers(n);return i.set("Host",x),new _e(c.toString(),{method:r,headers:i,signal:a,body:d})}class Ts extends Hs{constructor(t,r,n,a=zr){super(t,a);L(this,"hoW");if(zs())throw new Error("HoWHttpClientForWindow should not be used in Service Worker");this.hoW=new pr(r,n)}_fetch(t,r){return z(this,null,function*(){var c,x;const n=Me(),a=this.getFingerprint(new URL(r.url).host),d=yield this.hoW.fetch(t,n,r,a);return t.set("downloadConnectionAt",(c=t.get("hoWDataChannelOpenAt"))!=null?c:-1),t.set("downloadStartTransferAt",(x=t.get("hoWStartTransferAt"))!=null?x:-1),d})}dispose(){this.hoW.dispose()}}function zs(){const s=self;return!!(s.clients&&s.registration)}const Ls=new URL(l0).hostname;function qs(s,e,t){return z(this,null,function*(){var c;const r={url:e,cip:""},n=K0({appID:t.appID,appSalt:t.appSalt,path:l0}),a=yield fetch(l0,{method:"POST",body:JSON.stringify(r),headers:{"Content-Type":"application/json",Authorization:n}});if(s.set("dnsResolveStatus",a.status),s.set("dnsResolveReqID",(c=a.headers.get("x-reqid"))!=null?c:""),s.set("dnsResolveConnectionAt",Date.now()),s.set("dnsResolveServiceDomain",Ls),!a.ok)throw new Error(`Call Schedule API failed, status: ${a.status} ${a.statusText}`);return yield a.json()})}class Ws{constructor(e){this.logger=e}log(e){return this.logger.log("LiveScheduleLog",e)}}const Ke=we("dns"),Os=60,Fs=60*1e3;class Is{constructor(e,t,r=qs,n=Qe){L(this,"scheduling",new Map);L(this,"cache",new Map);L(this,"m3u8SegmentCache",new Map);L(this,"logger");this.app=t,this.scheduler=r,this.cacheUrl=n,this.logger=new Ws(e)}getScheduleResult(e,t){return z(this,null,function*(){var d,c,x,i,u;const r=Date.now();let n,a;try{let w;try{w=yield this.scheduler(e,t,this.app)}catch(f){throw console.warn("Live schedule failed:",f),new mr(f)}if(w.code===1)throw new je(`Local DNS for ${t}`);if(w.code!==0)throw new Error(`Unexpected schedule code: ${w.code}`);const o=(d=w.ttl)!=null?d:Os;return a=me(ee({},w),{expireAt:Date.now()+o*1e3,ips:w.ips.map(f=>({addr:f,after:0})),hosts:w.hosts.map(f=>({addr:f,after:0})),ttl:o}),a}catch(w){throw n=w,w}finally{const w=se(Date.now(),r),o=a==null?Ue(n):{err_msg:"",err_desc:""};this.logger.log(me(ee({r_id:(c=e.get("dnsResolveReqID"))!=null?c:"",ip:(x=e.get("dnsResolveServiceIP"))!=null?x:"",domain:(i=e.get("dnsResolveServiceDomain"))!=null?i:"",status_code:(u=e.get("dnsResolveStatus"))!=null?u:-1},o),{t_conn:se(e.get("dnsResolveConnectionAt"),r),t_total:w,type:1})),e.set("dnsResolveTotalTime",w)}})}saveM3u8SegmentResult(e,t){return z(this,null,function*(){const r=this.cacheUrl(e),n=this.cache.get(r);if(n==null){console.warn("No schedule result for m3u8:",e);return}const a=t.map(this.cacheUrl);a.forEach(d=>{this.m3u8SegmentCache.set(d,n)}),setTimeout(()=>{a.forEach(d=>{this.m3u8SegmentCache.delete(d)})},6e4)})}schedule(e,t){return z(this,null,function*(){const r=this.cacheUrl(t);if(!Je(t)&&!ur(t)){const c=this.m3u8SegmentCache.get(r);if(c==null)throw new je("Neither m3u8 / flv URL, or m3u8 segment URL");return c}const n=this.cache.get(r);if(n!=null&&ct(n))return e.set("dnsResolveFromCache",!0),n;const a=this.scheduling.get(r);if(a!=null){let c;try{c=yield a}catch(x){if(x instanceof je)throw x}if(c!=null&&ct(c))return e.set("dnsResolveFromCache",!0),c;this.scheduling.delete(r)}const d=this.getScheduleResult(e,t);return Ke("save scheduling for",t),this.scheduling.set(r,d),d.then(c=>{Ke("save cache for",t),this.cache.set(r,c)},()=>{}),d})}hasResult(e){const t=this.cacheUrl(e),r=Je(e)||ur(e)?this.cache.get(t):this.m3u8SegmentCache.get(t);return r!=null&&ct(r)}do(e,t,r,n,a){return z(this,null,function*(){let d;Ke("schedule for",t);const c=yield this.schedule(e,t),x=n?c.hosts:c.ips;Ke("scheduled for",t);for(let i=0;i<r;i++){const u=Ns(x);if(u==null)break;try{Ke(`do with ${n?"host":"IP"}`,u,t),yield a(u.addr),c.expireAt=Date.now()+c.ttl*1e3;return}catch(w){console.warn("do job with",u.addr,"failed:",w,t),n0(w)&&(u.after=Date.now()+Fs),d=w}}throw d=J0(d)?d:new _r(d),d})}}function it(s,e=Date.now()){return s.after<e}function Ns(s){for(const e of s)if(it(e))return e;return null}function ct(s){const e=Date.now();return s.expireAt<=e?!1:s.hosts.some(t=>it(t,e))&&s.ips.some(t=>it(t,e))}class Ms{constructor(e,t=!0,r=self.fetch){this.resolver=e,this.https=t,this.nativeFetch=r}resolve(e,t,r,n){return z(this,null,function*(){return this.resolver.do(e,t.url,r,!0,n)})}fetch(e,t,r){return z(this,null,function*(){const n=this.nativeFetch,a=$s(t,r,this.https),d=yield n(a),c=Date.now();return e.set("downloadConnectionAt",c),e.set("downloadStartTransferAt",c),r0(d)})}dispose(){}}function Us(s,e){return new Request(s,ee({mode:"cors",credentials:"omit"},e))}function $s(s,e,t=!0){const{url:r,headers:n,method:a,signal:d}=s,c=new URL(r),x=c.host,i=new Headers(n),[u,w]=cr(e),o=w+(t?443:80);c.protocol=t?"https:":"http:",c.host=`${u}:${o}`,c.pathname=`/${x}${c.pathname}`;let f=c.toString();if(i.has("X-Miku-Agent")){const l=i.get("X-Miku-Agent");i.delete("X-Miku-Agent");const h=f.includes("?")?"&":"?",v=["X-Miku-Agent",l].map(encodeURIComponent).join("=");f=f+h+v}return Us(f,{headers:i,method:a,signal:d,keepalive:!0})}function Gs(s){const e=[],t=s.split(`
`).map(n=>n.trim()).filter(n=>n.length>0);if(t[0]!=="#EXTM3U")throw new Error("Invalid Extended M3U Playlist");let r=null;for(const n of t){if(n.startsWith("#")){n.startsWith("#EXTINF:")&&(r=n);continue}r!=null&&(e.push({uri:n}),r=null)}return e}const Lr=we("client");class js{constructor(e,t){L(this,"fileTasks",new Map);L(this,"cache");L(this,"cacheUrlFn");L(this,"cdnResolver");L(this,"liveResolver");L(this,"http");L(this,"liveHttp");L(this,"liveOptimization");L(this,"patterns");L(this,"mediaOptimization");L(this,"logger");var d,c,x,i,u,w;t!=null&&t.debug&&ht(),this.cache=new cs(t==null?void 0:t.cache),this.cacheUrlFn=(d=t==null?void 0:t.cacheUrl)!=null?d:Xs,this.logger=(c=t==null?void 0:t.logger)!=null?c:new Bs(e),this.cdnResolver=new rs(this.logger,e,t==null?void 0:t.dnsResolver),this.liveResolver=(x=t==null?void 0:t.liveResolver)!=null?x:new Is(this.logger,e,t==null?void 0:t.scheduler);const r=(i=t==null?void 0:t.httpClient)!=null?i:new Ts(this.cdnResolver),n=(u=t==null?void 0:t.liveHttpClient)!=null?u:new Ms(this.liveResolver);this.patterns=ee(ee({},ir),t==null?void 0:t.patterns),this.mediaOptimization=ee(ee({},ms),t==null?void 0:t.mediaOptimization),this.http=new Sr(this.logger,r);const a=2e3;this.liveHttp=new Sr(this.logger,n,a),this.liveOptimization=(w=t==null?void 0:t.liveOptimization)!=null?w:!0}createTask(e,t){const r=e.indexOf("#");return r>=0&&(e=e.slice(0,r)),new Er(e,t!=null?t:null,Number.POSITIVE_INFINITY,this.logger,(n,a)=>(n.set("taskType",1),this.startTask(n,a)))}createLiveTask(e,t){const r=e.indexOf("#");return r>=0&&(e=e.slice(0,r)),new Er(e,t!=null?t:null,0,this.logger,(n,a)=>(n.set("taskType",2),this.startLiveTask(n,a)))}startTask(e,t){const r=this.cacheUrlFn(t.url);let n=this.fileTasks.get(r);return n==null&&(n=new ys(this.cache,this.http,r,t.url,this.patterns,this.mediaOptimization),this.fileTasks.set(r,n)),n.startTask(e,t)}saveM3u8SegmentResult(e,t){return z(this,null,function*(){const r=yield Wn(t),a=Gs(r).map(d=>qn(d.uri,e));Lr("saveM3u8SegmentResult",Qe(e),a.map(Qe)),yield this.liveResolver.saveM3u8SegmentResult(e,a)})}startLiveTask(e,t){return z(this,null,function*(){const r={};t.range!=null&&(r.Range=f0({start:t.range.start,end:t.range.end==null?null:t.range.end-1}));const n=new _e(t.url,{method:"GET",headers:r,signal:t.signal});let a,d=this.liveOptimization&&Je(t.url)&&!this.liveResolver.hasResult(t.url);if(d){Lr("use nativeDo for",t.url);const x=Br(e,n);this.liveHttp.do(e,n).catch(i=>{console.warn("do failed when prefetch for liveOptimization:",i)}),a=yield x}else a=yield this.liveHttp.do(e,n);if(a.body==null)throw new Error("Body expected");if(a.status!==200&&a.status!==206)throw new Error(`Invalid response, status: ${a.status}`);let c=a.body;if(!d&&Q0()&&Je(t.url)){const[x,i]=a.body.tee();this.saveM3u8SegmentResult(t.url,i).catch(u=>{console.warn("Save M3u8 segment cache failed:",t.url,u)}),c=x}return new Ar(c,Ye(a.headers),mt(a),a.headers.get("Content-Type"),a)})}dispose(){this.cache.dispose()}}function Xs(s){return s}function Ks(s){return s&&s.mikuProxy===!0}const Vs="MIKU_PROXY_CONFIG";function Ys(s,e){const t=n=>n==null?void 0:n.map(a=>({source:a.source,flags:a.flags})),r=me(ee({},e),{patterns:e.patterns==null?void 0:ar(e.patterns,n=>t(n))});return Pn(s,{[Vs]:JSON.stringify(r)})}function Zs(s){return Array.isArray(s)?{cdn:s,live:[]}:ee({cdn:[],live:[]},s)}function Qs(s){const e={},t=[];for(const{url:r,ecdn:n,fallback:a}of s){const d=new URL(r),c=d.hostname,x=lr(d.pathname);if(c!=="localhost"&&c.indexOf(".")<0||/\.qnqcdn\.net$/.test(c))continue;let i=e[c];i==null&&(e[c]=i={exts:[],total:0,ecdn:0,fallback:0}),i.exts.includes(x)||i.exts.push(x),i.total++,n&&i.ecdn++,a&&i.fallback++,Ln(d,ir)&&!t.includes(c)&&t.push(c)}return e}function Js(s,e){const t={};for(const{url:r,ecdn:n,size:a}of e){const d=new URL(r),c=d.hostname,x=lr(d.pathname);if(!(!s.includes(c)&&!s.includes("*")))for(const i of[`${c}/*`,`${c}/*.${x||"<none>"}`]){let u=t[i];u==null&&(t[i]=u={total:0,totalSize:0,ecdn:0,ecdnSize:0}),u.total++,u.totalSize+=a!=null?a:0,n&&(u.ecdn++,u.ecdnSize+=a!=null?a:0)}}return t}function ea(s,e,t){return z(this,null,function*(){s=Ys(s,e),yield navigator.serviceWorker.register(s,t)})}function ta(){return z(this,null,function*(){new As().run(),ra()})}function ra(){function s(e){var r;const t={mikuProxy:!0,type:`window-${e}`};(r=navigator.serviceWorker.controller)==null||r.postMessage(t)}s("available"),window.addEventListener("pageshow",()=>s("available")),window.addEventListener("pagehide",()=>s("unavailable")),window.addEventListener("beforeunload",()=>s("unavailable"))}function na(s,e){navigator.serviceWorker.addEventListener("message",({data:t})=>{if(!Ks(t)||t.type!=="window-fetch-items")return;const r=Qs(t.items),n=Zs(s.domains),a=Js([...n.cdn,...n.live],t.items);e(r,a)}),window.addEventListener("load",()=>{setTimeout(()=>{var r;const t={mikuProxy:!0,type:"get-window-fetch-items"};(r=navigator.serviceWorker.controller)==null||r.postMessage(t)},1e3)})}function sa(s,e,t){return z(this,null,function*(){const r=aa();if(r!=null){console.warn("Ability not OK for Miku Proxy API:",r);return}e.debug&&ht(),yield Promise.all([ta(),ea(s,e,t)])})}function aa(){return"serviceWorker"in navigator?null:"navigator.serviceWorker not available"}return Z.Client=js,Z.initProxy=sa,Z.listenStatistics=na,Object.defineProperties(Z,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}}),Z}({});
